window.__require=function e(t,s,i){function o(c,h){if(!s[c]){if(!t[c]){var r=c.split("/");if(r=r[r.length-1],!t[r]){var n="function"==typeof __require&&__require;if(!h&&n)return n(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+c+"'")}}var l=s[c]={exports:{}};t[c][0].call(l.exports,function(e){return o(t[c][1][e]||e)},l,l.exports,e,t,s,i)}return s[c].exports}for(var a="function"==typeof __require&&__require,c=0;c<i.length;c++)o(i[c]);return o}({AudioMgr:[function(e,t,s){"use strict";cc._RF.push(t,"b937cjNkW1J9b8DNw/Ms6Rw","AudioMgr");cc.Class({extends:cc.Component,properties:{bgmVolume:1,sfxVolume:1,bgmAudioID:-1,musicState:1},init:function(){var e;cc.Mgr.loadSound=!1,null!=(e=cc.sys.localStorage.getItem("bgmVolume"))&&(this.bgmVolume=parseFloat(e)),null!=(e=cc.sys.localStorage.getItem("sfxVolume"))&&(this.sfxVolume=parseFloat(e)),cc.game.on(cc.game.EVENT_HIDE,function(){console.log("cc.audioEngine.pauseAll"),cc.audioEngine.pauseAll()}),cc.game.on(cc.game.EVENT_SHOW,function(){console.log("cc.audioEngine.resumeAll"),cc.audioEngine.resumeAll()})},getUrl:function(e){return cc.url.raw("resources/sound/"+e+".mp3")},playBGM:function(e){var t=this.getUrl(e);this.bgmAudioID>=0&&cc.audioEngine.stop(this.bgmAudioID),this.bgmAudioID=cc.audioEngine.play(t,!0,this.bgmVolume)},playSFX:function(e){var t=this.getUrl(e);cc.audioEngine.play(t,!1,this.sfxVolume)},setSFXVolume:function(e){this.sfxVolume!=e&&(cc.sys.localStorage.setItem("sfxVolume",e),this.sfxVolume=e)},setBGMVolume:function(e,t){this.bgmAudioID>=0&&(e>0?cc.audioEngine.resume(this.bgmAudioID):cc.audioEngine.pause(this.bgmAudioID)),(this.bgmVolume!=e||t)&&(cc.sys.localStorage.setItem("bgmVolume",e),this.bgmVolume=e,cc.audioEngine.setVolume(this.bgmAudioID,e))},pauseAll:function(){this.musicState=0,this.bgmVolume=0,this.sfxVolume=0,cc.audioEngine.pauseAll()},resumeAll:function(){this.musicState=1,this.bgmVolume=1,this.sfxVolume=1,cc.audioEngine.resumeAll()},getVoiceState:function(){return this.musicState}});cc._RF.pop()},{}],DIR:[function(e,t,s){"use strict";cc._RF.push(t,"bdbae+CdhxEFKxoI+IJYJNX","DIR");var i=cc.Enum({LEFT:1,UP:2,RIGHT:3,DOWN:4});t.exports=i,cc._RF.pop()},{}],EffectNode:[function(e,t,s){"use strict";cc._RF.push(t,"46e4c3Z6vtLHqA5AZ14JnkR","EffectNode");var i=cc.Class({extends:cc.Component,properties:{MergeUpNode:cc.Node,MergeLNode:cc.Node,MergeRNode:cc.Node,MergeULNode:cc.Node,MergeURNode:cc.Node,MergeMNode:cc.Node,MergeURLNode:cc.Node,ScoreGetLbl:cc.Label,MergeExploreObj:cc.Node},EndScoreExplore:function(){cc.log("+++++++++++++++++eeeeee+++++++++++++++++++++"),this.ScoreGetLbl.node.active=!1,this.MergeExploreObj.active=!1,this.MergeURLNode.active=!1,this.MergeUpNode.active=!1,this.MergeLNode.active=!1,this.MergeURNode.active=!1,this.MergeULNode.active=!1,this.MergeRNode.active=!1,this.MergeMNode.active=!1}});t.exports=i,cc._RF.pop()},{}],GameOverPanel:[function(e,t,s){"use strict";cc._RF.push(t,"0cdcempq+VNQrB8znADbd/t","GameOverPanel");var i=cc.Class({extends:cc.Component,properties:{DesLbl:cc.Label},ShowPanel:function(e){this.DesLbl.string=e.text},ReStartGame:function(){}});t.exports=i,cc._RF.pop()},{}],MergeType:[function(e,t,s){"use strict";cc._RF.push(t,"6c247wLt2dAQ4fA9zU4zX05","MergeType");var i=cc.Enum({NULL:0,UPickD:1,UFour:2,UThreeS:3,UThreeL:4,UThreeR:5,UTwoD:6,NFour:7,NThreeS:8,NThreeL:9,NThreeR:10,TwoD:11,TwoL:12,TwoR:13,MergeTmpLv:99});t.exports=i,cc._RF.pop()},{}],NextBoxDataListSpawn:[function(e,t,s){"use strict";cc._RF.push(t,"5d406Ak6GNJMqRLUHTlj8NW","NextBoxDataListSpawn");var i=cc.Class({extends:cc.Component,properties:{Atlas:cc.SpriteAtlas,NextOne:cc.Sprite,NextTwo:cc.Sprite,NextThree:cc.Sprite},InitList:function(){this.NextThree.node.active=!0,this.nextBoxList=new Array(4);for(var e=0;e<=3;e++){var t=Math.floor(6*Math.random())+1;if(Math.random()>.95&&(t=-1),this.nextBoxList[e]=t,0==e){var s="Sp_"+Math.floor(Math.pow(2,t));this.NextOne.spriteFrame=this.Atlas.getSpriteFrame(s)}else if(1==e){s="Sp_"+Math.floor(Math.pow(2,t));this.NextTwo.spriteFrame=this.Atlas.getSpriteFrame(s)}else if(2==e){s="Sp_"+Math.floor(Math.pow(2,t));this.NextThree.spriteFrame=this.Atlas.getSpriteFrame(s)}}},SetNextListActive:function(e){this.NextTwo.node.active=e,this.NextThree.node.active=e},getNextElement:function(){var e=this.nextBoxList.shift(),t=Math.floor(6*Math.random())+1;return Math.random()>.95&&(t=-1),this.nextBoxList.push(t),this.RefreshNextListShow(),e},RefreshNextListShow:function(){var e="Sp_"+Math.floor(Math.pow(2,this.nextBoxList[0]));this.NextOne.spriteFrame=this.Atlas.getSpriteFrame(e);var t="Sp_"+Math.floor(Math.pow(2,this.nextBoxList[1]));this.NextThree.spriteFrame=this.Atlas.getSpriteFrame(t);var s="Sp_"+Math.floor(Math.pow(2,this.nextBoxList[2]));this.NextThree.spriteFrame=this.Atlas.getSpriteFrame(s)},start:function(){}});t.exports=i,cc._RF.pop()},{}],OverPanel:[function(e,t,s){"use strict";cc._RF.push(t,"23a20uGjnJBQ5YEaA24hIqQ","OverPanel");var i=e("RankItem"),o=cc.Class({extends:cc.Component,properties:{scoreLbl:cc.Label,highLbl:cc.Label,topScoreSp:cc.Node,rankItemA:i,rankItemB:i,rankItemC:i},SeeAllRank:function(){},ReStartGame:function(){},DoubleScoreReStart:function(){}});t.exports=o,cc._RF.pop()},{RankItem:"RankItem"}],PausePanel:[function(e,t,s){"use strict";cc._RF.push(t,"3fc060JFRNHSoM1re+mV3sB","PausePanel");var i=cc.Class({extends:cc.Component,properties:{}});t.exports=i,cc._RF.pop()},{}],RankItem:[function(e,t,s){"use strict";cc._RF.push(t,"5b2a26NdrRG34WjZiTeSrJM","RankItem");var i=cc.Class({extends:cc.Component,properties:{rankLbl:cc.Label,headIcon:cc.Sprite,scoreLbl:cc.Label,nameLbl:cc.Label},InitData:function(e){}});t.exports=i,cc._RF.pop()},{}],RankPanel:[function(e,t,s){"use strict";cc._RF.push(t,"0133aM3x0JGsIlpbolWcjCM","RankPanel");var i=e("RankItem"),o=cc.Class({extends:cc.Component,properties:{rankItem:cc.Prefab,itemParent:cc.Node,MyRank:i},ShowPanel:function(e){for(var t=this.itemParent.children,s=0;s<=t.length-1;s++)t[s].active=!1;for(s=0;s<=e.length-1;s++)if(s<t.length){var i=t[s].getComponent("RankItem");null!=i&&(i.InitData(e[s]),t[s].active=!0)}else{var o=cc.instantiate(this.rankItem);o.parent=this.itemParent,o.getComponent("RankItem").InitData(e[s]),o.active=!0}},ClosePanel:function(){this.node.active=!1}});t.exports=o,cc._RF.pop()},{RankItem:"RankItem"}],RebornPanel:[function(e,t,s){"use strict";cc._RF.push(t,"5a0d7kti1NCVKU1U9ia+AwK","RebornPanel");var i=cc.Class({extends:cc.Component,properties:{myscoreLbl:cc.Label,HeadIcon:cc.Sprite,nameLbl:cc.Label,scoreLbl:cc.Label},ShowPanel:function(e){}});t.exports=i,cc._RF.pop()},{}],RewardPanel:[function(e,t,s){"use strict";cc._RF.push(t,"a101cDZ4qxM8oxj5e7H6KcX","RewardPanel");var i=cc.Class({extends:cc.Component,properties:{Anima:cc.Animation},ShowPanel:function(){this.Anima.play("RewardEffect")},ClosePanel:function(){this.node.active=!1}});t.exports=i,cc._RF.pop()},{}],ScoreEnum:[function(e,t,s){"use strict";cc._RF.push(t,"15a22bO6/ZGXZ8u9FlObu4K","ScoreEnum"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],ScoreMgr:[function(e,t,s){"use strict";cc._RF.push(t,"64b0f8KsBlL8pH1kwXrDYbY","ScoreMgr");cc.Class({extends:cc.Component,properties:{score:cc.Integer,ScoreLbl:cc.Label},AddScoreFunc:function(e){this.score+=e,this.ScoreLbl.string=this.score},ResetScore:function(){this.score=0,this.ScoreLbl.string="0"}});cc._RF.pop()},{}],SkillState:[function(e,t,s){"use strict";cc._RF.push(t,"cfcc2w3lc1MqqFXJyF+KVHR","SkillState");var i=cc.Class({extends:cc.Component,properties:{}});t.exports=i,cc._RF.pop()},{}],TZBoard:[function(e,t,s){"use strict";cc._RF.push(t,"451c6teYCNOOKGm/HJkHCz3","TZBoard");var i=e("DIR"),o=e("TZGameState"),a=e("TZState"),c=(e("TZBox"),e("MergeType")),h=e("TZGlobalData"),r=e("ScoreMgr"),n=e("NextBoxDataListSpawn"),l=cc.Class({extends:cc.Component,properties:{colsNum:6,rowsNum:8,parentNode:cc.Node,gameState:{default:o.Wait,type:o},checkPos:{default:[],type:[cc.Integer]},UIStartPanel:cc.Node,UIOverPanel:cc.Node,ScoreMgr:r,NextDataList:n},OffTouchEventListener:function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onTouched,this)},AddTouchEventListener:function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouched,this)},onLoad:function(){cc.director.getCollisionManager().enabled=!1,this.gameState=o.Wait;var e=this.parentNode.children;this.boxMap=new Array(this.rowsNum);for(var t=0;t<this.rowsNum;t++){for(var s=new Array(this.colsNum),i=0;i<this.colsNum;i++){var a=t*this.colsNum+i;s[i]=e[a].getComponent("TZBox")}this.boxMap[t]=s}for(t=0;t<this.rowsNum;t++)for(i=0;i<this.colsNum;i++)this.boxMap[t][i].InitBox(t,i);this.NextDataList.InitList(),this.ScoreMgr.ResetScore(),this.NextDataList.SetNextListActive(!1),this.addListeners(),this.schedule(function(){this.AutoMoveDown()},1);var c=this;cc.director.on("UsingChuiZi",function(e){cc.log("\u5a18\u5e0c\u5339 \u4f7f\u7528\u9524\u5b50\u54e6"),c.AddTouchEventListener(),h.SkillHammer=!1,c.scheduleOnce(function(){c.SlowDownAfterUseSkill()},.25)}),cc.director.on("UsingDouble",function(e){cc.log("\u5a18\u5e0c\u5339 \u4f7f\u7528\u53cc\u500d\u54e6"),h.SkillDouble=!1,c.AddTouchEventListener(),c.scheduleOnce(function(){c.SlowDownAfterUseSkill()},.25)}),cc.director.on("SkillChange",function(e){cc.log("\u5a18\u5e0c\u5339 \u4f7f\u7528\u4ea4\u6362\u54e6"),2==h.selectedNum&&(h.SkillChange=!1,c.AddTouchEventListener(),cc.log("\u5df2\u7ecf\u9009\u4e2d\u4e24\u4e2a\u4e86==========="),c.ExchangeSelectedBox(),h.selectedNum=0,c.scheduleOnce(function(){c.SlowDownAfterUseSkill()},.25))})},ExchangeSelectedBox:function(){for(var e={},t={},s=0,i=this.rowsNum-1;i>0;i--)for(var o=0;o<this.colsNum;o++)if(1==this.boxMap[i][o].selected){if(cc.log("======\u8df3\u51fa\u88ab\u9009\u4e2d\u7684======"),0!=s){t.row=i,t.col=o,t.flagNum=this.boxMap[i][o].flagNum,cc.log("======\u8df3\u51fa\u88ab\u9009\u4e2d\u7684 Box2 ======"+t.flagNum);break}e.row=i,e.col=o,e.flagNum=this.boxMap[i][o].flagNum,cc.log("======\u8df3\u51fa\u88ab\u9009\u4e2d\u7684 Box1 ======"+e.flagNum),s+=1}null!=e.row&&null!=t.row&&(this.boxMap[e.row][e.col].RefreshBoxAfterChange(t),this.boxMap[t.row][t.col].RefreshBoxAfterChange(e))},SlowDownAfterUseSkill:function(){var e={},t=!1,s={},i=c.MergeTmpLv,r=c.NULL;cc.log("\u4f7f\u7528\u6280\u80fd\u540e   \u68c0\u6d4b\u662f\u5426\u9700\u8981\u4e0b\u843d");for(var n=this.colsNum-1;n>=0;n--)for(var l=this.rowsNum-1;l>1;l--)if(0==this.boxMap[l][n].flagNum&&0==this.boxMap[l-1][n].flagNum&&0==this.boxMap[l-2][n].flagNum&&l>2&&0!=this.boxMap[l-3][n].flagNum)if(cc.log("\u4e0b\u843d\u70b9 = "+this.checkPos[0]+"  "+this.checkPos[1]+"  \u4f7f\u7528\u6280\u80fd\u540e33333   \u68c0\u6d4b\u662f\u5426\u9700\u8981\u4e0b\u843d = "+(l-3)+" "+n),l-3==this.checkPos[0]&&n==this.checkPos[1]);else{cc.log("\u4f7f\u7528\u6280\u80fd\u540e33333   \u68c0\u6d4b\u662f\u5426\u9700\u8981\u4e0b\u843d  "),(u={}).state=a.Fixed,u.flagNum=this.boxMap[l-3][n].flagNum;u.flagNum;this.boxMap[l][n].RefreshBox(u),u.state=a.canMove,u.flagNum=0,this.boxMap[l-3][n].RefreshBox(u)}else if(0==this.boxMap[l][n].flagNum&&0==this.boxMap[l-1][n].flagNum&&0!=this.boxMap[l-2][n].flagNum)if(cc.log("\u4e0b\u843d\u70b9 = "+this.checkPos[0]+"  "+this.checkPos[1]+"  \u4f7f\u7528\u6280\u80fd\u540e22222   \u68c0\u6d4b\u662f\u5426\u9700\u8981\u4e0b\u843d = "+(l-2)+" "+n),l-2==this.checkPos[0]&&n==this.checkPos[1]);else{cc.log("\u4f7f\u7528\u6280\u80fd\u540e22222   \u68c0\u6d4b\u662f\u5426\u9700\u8981\u4e0b\u843d  "),(u={}).state=a.Fixed,u.flagNum=this.boxMap[l-2][n].flagNum;u.flagNum;this.boxMap[l][n].RefreshBox(u),u.state=a.canMove,u.flagNum=0,this.boxMap[l-2][n].RefreshBox(u)}else if(0==this.boxMap[l][n].flagNum&&0!=this.boxMap[l-1][n].flagNum)if(cc.log("\u4e0b\u843d\u70b9 = "+this.checkPos[0]+"  "+this.checkPos[1]+"  \u4f7f\u7528\u6280\u80fd\u540e11111   \u68c0\u6d4b\u662f\u5426\u9700\u8981\u4e0b\u843d = "+(l-1)+" "+n),l-1==this.checkPos[0]&&n==this.checkPos[1]);else{var u;cc.log("\u4f7f\u7528\u6280\u80fd\u540e11111   \u68c0\u6d4b\u662f\u5426\u9700\u8981\u4e0b\u843d"),(u={}).state=a.Fixed,u.flagNum=this.boxMap[l-1][n].flagNum;u.flagNum;this.boxMap[l][n].RefreshBox(u),u.state=a.canMove,u.flagNum=0,this.boxMap[l-1][n].RefreshBox(u)}for(n=this.rowsNum-1;n>0;n--)for(l=0;l<this.colsNum;l++)if(0!=this.boxMap[n][l].flagNum){var g={};g.row=n,g.col=l,g.flagNum=this.boxMap[n][l].flagNum;var p=this.CheckCanMerge(g);p.mergeType!=c.NULL&&i>p.mergeType&&(i=p.mergeType,t=!0,e=g,r=p.mergeType,cc.log("\u4f7f\u7528\u6280\u80fd   \u4e0b\u843d\u540e\u6709\u9700\u8981\u5408\u5e76\u7684 "+i))}s.hasOne=t,s.posBox=e,s.mergeType=r,0==s.hasOne?(this.gameState=o.Play,h.UsingSkill=!1,h.SkillHammer=!1,h.SkillChange=!1,h.SkillDouble=!1):this.OperateMergeAfterUseSkill(s)},OperateMergeAfterUseSkill:function(e){switch(e.mergeType){case c.NFour:this.MergeNFour(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)s!=this.checkPos[0]&&e.col!=this.checkPos[1]&&this.boxMap[s][e.col].RefreshToInitState();this.SlowDownAfterUseSkill()},h.MergeLaterTime):this.scheduleOnce(function(){this.SlowDownAfterUseSkill()},h.MergeLaterTime)});break;case c.NThreeS:this.MergeNThreeS(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)s!=this.checkPos[0]&&e.col!=this.checkPos[1]&&this.boxMap[s][e.col].RefreshToInitState();this.SlowDownAfterUseSkill()},h.MergeLaterTime):this.scheduleOnce(function(){this.SlowDownAfterUseSkill()},h.MergeLaterTime)});break;case c.NThreeL:this.MergeNThreeL(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)s!=this.checkPos[0]&&e.col!=this.checkPos[1]&&this.boxMap[s][e.col].RefreshToInitState();this.SlowDownAfterUseSkill()},h.MergeLaterTime):this.scheduleOnce(function(){this.SlowDownAfterUseSkill()},h.MergeLaterTime)});break;case c.NThreeR:this.MergeNThreeR(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)s!=this.checkPos[0]&&e.col!=this.checkPos[1]&&this.boxMap[s][e.col].RefreshToInitState();this.SlowDownAfterUseSkill()},h.MergeLaterTime):this.scheduleOnce(function(){this.SlowDownAfterUseSkill()},h.MergeLaterTime)});break;case c.TwoD:this.MergeNTwoD(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)s!=this.checkPos[0]&&this.boxMap[s][e.col].RefreshToInitState();this.SlowDownAfterUseSkill()},h.MergeLaterTime):this.scheduleOnce(function(){this.SlowDownAfterUseSkill()},h.MergeLaterTime)});break;case c.TwoL:this.MergeNTwoL(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)s!=this.checkPos[0]&&this.boxMap[s][e.col].RefreshToInitState();this.SlowDownAfterUseSkill()},h.MergeLaterTime):this.scheduleOnce(function(){this.SlowDownAfterUseSkill()},h.MergeLaterTime)});break;case c.TwoR:this.MergeNTwoR(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)s!=this.checkPos[0]&&this.boxMap[s][e.col].RefreshToInitState();this.SlowDownAfterUseSkill()},h.MergeLaterTime):this.scheduleOnce(function(){this.SlowDownAfterUseSkill()},h.MergeLaterTime)})}},AutoMoveDown:function(){this.MoveBoxDown(i.DOWN)},SpawnBox:function(){if(this.gameState==o.Play){var e=this.NextDataList.getNextElement(),t=Math.floor(Math.random()*this.colsNum);if(this.boxMap[0][t].SpawnBox(e),this.checkPos[0]=0,this.checkPos[1]=t,h.setCheckPos(this.checkPos),0==this.checkCanMove(i.DOWN)){this.gameState=o.Check,this.boxMap[this.checkPos[0]][this.checkPos[1]].RefreshState(a.Fixed);var s={row:0};s.col=t,s.flagNum=this.boxMap[this.checkPos[0]][this.checkPos[1]].flagNum;var r=this.CheckCanMerge(s);if(r.mergeType==c.NULL)return this.gameState,o.Over,void this.scheduleOnce(function(){cc.Mgr.AudioMgr.playSFX("death"),this.UIOverPanel.active=!0,cc.log("\u6e38\u620f\u7ed3\u675f")},h.ShowOverTime);this.OperateMerge(r)}}},CheckSpawnBoxCanMove:function(){return!!this.checkCanMove(i.DOWN)||(!!this.checkCanMove(i.LEFT)||!!this.checkCanMove(i.RIGHT))},CheckBoxFlagSame:function(e,t){return e.flagNum==t.flagNum},CheckSlowDown:function(){for(var e={},t=!1,s={},i=c.MergeTmpLv,o=c.NULL,h=this.colsNum-1;h>=0;h--)for(var r=this.rowsNum-1;r>1;r--)if(0==this.boxMap[r][h].flagNum&&0==this.boxMap[r-1][h].flagNum&&0!=this.boxMap[r-2][h].flagNum){(n={}).state=a.Fixed,n.flagNum=this.boxMap[r-2][h].flagNum;n.flagNum;this.boxMap[r][h].RefreshBox(n),n.state=a.canMove,n.flagNum=0,this.boxMap[r-2][h].RefreshBox(n)}else if(0==this.boxMap[r][h].flagNum&&0!=this.boxMap[r-1][h].flagNum){var n;(n={}).state=a.Fixed,n.flagNum=this.boxMap[r-1][h].flagNum;n.flagNum;this.boxMap[r][h].RefreshBox(n),n.state=a.canMove,n.flagNum=0,this.boxMap[r-1][h].RefreshBox(n)}for(h=this.rowsNum-1;h>0;h--)for(r=0;r<this.colsNum;r++)if(0!=this.boxMap[h][r].flagNum){var l={};l.row=h,l.col=r,l.flagNum=this.boxMap[h][r].flagNum;var u=this.CheckCanMerge(l);u.mergeType!=c.NULL&&i>u.mergeType&&(i=u.mergeType,t=!0,e=l,o=u.mergeType,cc.log("\u4e0b\u843d\u540e\u6709\u9700\u8981\u5408\u5e76\u7684 "+i))}return s.hasOne=t,s.posBox=e,s.mergeType=o,s},RefreshBoxInit:function(e){var t={};t.state=a.canMove,t.flagNum=0,this.boxMap[e.row][e.col].RefreshBox(t)},OperateMerge:function(e){if(e.mergeType==c.NULL)this.gameState=o.Play,this.SpawnBox();else switch(e.mergeType){case c.UPickD:this.MergeUPickD(e.posBox,function(){this.gameState=o.Play,this.SpawnBox()});break;case c.UFour:this.MergeUFour(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)this.boxMap[s][e.col].RefreshToInitState();var i=this.CheckSlowDown();0==i.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(i)},h.MergeLaterTime):this.scheduleOnce(function(){var e=this.CheckSlowDown();0==e.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(e)},h.MergeLaterTime)});break;case c.UThreeS:this.MergeUThreeS(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)this.boxMap[s][e.col].RefreshToInitState();var i=this.CheckSlowDown();0==i.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(i)},h.MergeLaterTime):this.scheduleOnce(function(){var e=this.CheckSlowDown();0==e.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(e)},h.MergeLaterTime)});break;case c.UThreeL:this.MergeUThreeL(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)this.boxMap[s][e.col].RefreshToInitState();var i=this.CheckSlowDown();0==i.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(i)},h.MergeLaterTime):this.scheduleOnce(function(){var e=this.CheckSlowDown();0==e.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(e)},h.MergeLaterTime)});break;case c.UThreeR:this.MergeUThreeR(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)this.boxMap[s][e.col].RefreshToInitState();var i=this.CheckSlowDown();0==i.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(i)},h.MergeLaterTime):this.scheduleOnce(function(){var e=this.CheckSlowDown();0==e.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(e)},h.MergeLaterTime)});break;case c.UTwoD:this.MergeUTwoD(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)this.boxMap[s][e.col].RefreshToInitState();var i=this.CheckSlowDown();0==i.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(i)},h.MergeLaterTime):this.scheduleOnce(function(){var e=this.CheckSlowDown();0==e.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(e)},h.MergeLaterTime)});break;case c.NFour:this.MergeNFour(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)this.boxMap[s][e.col].RefreshToInitState();var i=this.CheckSlowDown();0==i.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(i)},h.MergeLaterTime):this.scheduleOnce(function(){var e=this.CheckSlowDown();0==e.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(e)},h.MergeLaterTime)});break;case c.NThreeS:this.MergeNThreeS(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)this.boxMap[s][e.col].RefreshToInitState();var i=this.CheckSlowDown();0==i.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(i)},h.MergeLaterTime):this.scheduleOnce(function(){var e=this.CheckSlowDown();0==e.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(e)},h.MergeLaterTime)});break;case c.NThreeL:this.MergeNThreeL(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)this.boxMap[s][e.col].RefreshToInitState();var i=this.CheckSlowDown();0==i.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(i)},h.MergeLaterTime):this.scheduleOnce(function(){var e=this.CheckSlowDown();0==e.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(e)},h.MergeLaterTime)});break;case c.NThreeR:this.MergeNThreeR(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)this.boxMap[s][e.col].RefreshToInitState();var i=this.CheckSlowDown();0==i.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(i)},h.MergeLaterTime):this.scheduleOnce(function(){var e=this.CheckSlowDown();0==e.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(e)},h.MergeLaterTime)});break;case c.TwoD:this.MergeNTwoD(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)this.boxMap[s][e.col].RefreshToInitState();var i=this.CheckSlowDown();0==i.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(i)},h.MergeLaterTime):this.scheduleOnce(function(){var e=this.CheckSlowDown();0==e.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(e)},h.MergeLaterTime)});break;case c.TwoL:this.MergeNTwoL(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)this.boxMap[s][e.col].RefreshToInitState();var i=this.CheckSlowDown();0==i.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(i)},h.MergeLaterTime):this.scheduleOnce(function(){var e=this.CheckSlowDown();0==e.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(e)},h.MergeLaterTime)});break;case c.TwoR:this.MergeNTwoR(e.posBox,function(e){11==e.flagNum?this.scheduleOnce(function(){for(var t=this.colsNum-1;t>=0;t--)this.boxMap[e.row][t].RefreshToInitState();for(var s=this.rowsNum-1;s>=0;s--)this.boxMap[s][e.col].RefreshToInitState();var i=this.CheckSlowDown();0==i.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(i)},h.MergeLaterTime):this.scheduleOnce(function(){var e=this.CheckSlowDown();0==e.hasOne?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(e)},h.MergeLaterTime)})}},MergeUPickD:function(e,t){var s=this;s.func=t,this.gameState=o.Merge,this.scheduleOnce(function(){this.RefreshBoxInit(e),this.gameState=o.Play,s.func()},h.MergeIntervalTime)},MergeUFour:function(e,t){var s=this;s.func=t,this.gameState=o.Merge,this.scheduleOnce(function(){var t=e.row,i=e.col,o=this.boxMap[t+1][i].flagNum,h={};h.state=a.canMove,h.flagNum=0,this.boxMap[t][i-1].RefreshBox(h),this.boxMap[t][i].RefreshBox(h),this.boxMap[t][i+1].RefreshBox(h),this.boxMap[t+1][i].PlayMergeAni(c.UFour),o+3>11?(h.state=a.Fixed,h.flagNum=11,this.boxMap[t+1][i].RefreshBox(h)):(h.state=a.Fixed,h.flagNum=o+3,this.boxMap[t+1][i].RefreshBox(h)),this.ScoreMgr.AddScoreFunc(Math.pow(2,h.flagNum));var r={};r.flagNum=h.flagNum,r.row=t+1,r.col=i,s.func(r)},h.MergeIntervalTime)},MergeUThreeS:function(e,t){var s=this;s.func=t,this.gameState=o.Merge,this.scheduleOnce(function(){var t=e.row,i=e.col,o=this.boxMap[t][i-1].flagNum,h={};h.state=a.canMove,h.flagNum=0,this.boxMap[t][i-1].RefreshBox(h),this.boxMap[t][i+1].RefreshBox(h),this.boxMap[t][i].PlayMergeAni(c.UThreeS),o+2>11?(h.state=a.Fixed,h.flagNum=11,this.boxMap[t][i].RefreshBox(h)):(h.state=a.Fixed,h.flagNum=o+2,this.boxMap[t][i].RefreshBox(h)),this.ScoreMgr.AddScoreFunc(Math.pow(2,h.flagNum));var r={};r.flagNum=h.flagNum,r.row=t,r.col=i,s.func(r)},h.MergeIntervalTime)},MergeUThreeL:function(e,t){var s=this;s.func=t,this.gameState=o.Merge,this.scheduleOnce(function(){var t=e.row,i=e.col,o=this.boxMap[t+1][i].flagNum,h={};h.state=a.canMove,h.flagNum=0,this.boxMap[t][i-1].RefreshBox(h),this.boxMap[t][i].RefreshBox(h),this.boxMap[t+1][i].PlayMergeAni(c.UThreeL),o+2>11?(h.state=a.Fixed,h.flagNum=11,this.boxMap[t+1][i].RefreshBox(h)):(h.state=a.Fixed,h.flagNum=o+2,this.boxMap[t+1][i].RefreshBox(h)),this.ScoreMgr.AddScoreFunc(Math.pow(2,h.flagNum));var r={};r.flagNum=h.flagNum,r.row=t+1,r.col=i,s.func(r)},h.MergeIntervalTime)},MergeUThreeR:function(e,t){var s=this;s.func=t,this.gameState=o.Merge,this.scheduleOnce(function(){var t=e.row,i=e.col,o=this.boxMap[t+1][i].flagNum,h={};h.state=a.canMove,h.flagNum=0,this.boxMap[t][i].RefreshBox(h),this.boxMap[t][i+1].RefreshBox(h),this.boxMap[t+1][i].PlayMergeAni(c.UThreeR),o+2>11?(h.state=a.Fixed,h.flagNum=11,this.boxMap[t+1][i].RefreshBox(h)):(h.state=a.Fixed,h.flagNum=o+2,this.boxMap[t+1][i].RefreshBox(h)),this.ScoreMgr.AddScoreFunc(Math.pow(2,h.flagNum));var r={};r.flagNum=h.flagNum,r.row=t+1,r.col=i,s.func(r)},h.MergeIntervalTime)},MergeUTwoD:function(e,t){var s=this;s.func=t,this.gameState=o.Merge,this.scheduleOnce(function(){var t=e.row,i=e.col,o=this.boxMap[t+1][i].flagNum,h={};h.state=a.canMove,h.flagNum=0,this.boxMap[t][i].RefreshBox(h),this.boxMap[t+1][i].PlayMergeAni(c.UTwoD),o+1>11?(h.state=a.Fixed,h.flagNum=11,this.boxMap[t+1][i].RefreshBox(h)):(h.state=a.Fixed,h.flagNum=o+1,this.boxMap[t+1][i].RefreshBox(h)),this.ScoreMgr.AddScoreFunc(Math.pow(2,h.flagNum));var r={};r.flagNum=h.flagNum,r.row=t+1,r.col=i,s.func(r)},h.MergeIntervalTime)},MergeNFour:function(e,t){var s=this;s.func=t,this.gameState=o.Merge,this.scheduleOnce(function(){var t=e.row,i=e.col,o=e.flagNum,h={};h.state=a.canMove,h.flagNum=0,this.boxMap[t][i-1].RefreshBox(h),this.boxMap[t][i+1].RefreshBox(h),this.boxMap[t][i].RefreshBox(h),this.boxMap[t+1][i].PlayMergeAni(c.NFour),o+3>11?(h.state=a.Fixed,h.flagNum=11,this.boxMap[t+1][i].RefreshBox(h)):(h.state=a.Fixed,h.flagNum=o+3,this.boxMap[t+1][i].RefreshBox(h)),this.ScoreMgr.AddScoreFunc(Math.pow(2,h.flagNum));var r={};r.flagNum=h.flagNum,r.row=t+1,r.col=i,s.func(r)},h.MergeIntervalTime)},MergeNThreeS:function(e,t){var s=this;s.func=t,this.gameState=o.Merge,this.scheduleOnce(function(){var t=e.row,i=e.col,o=e.flagNum,h={};h.state=a.canMove,h.flagNum=0,this.boxMap[t][i-1].RefreshBox(h),this.boxMap[t][i+1].RefreshBox(h),this.boxMap[t][i].PlayMergeAni(c.NThreeS),o+2>11?(h.state=a.Fixed,h.flagNum=11,this.boxMap[t][i].RefreshBox(h)):(h.state=a.Fixed,h.flagNum=o+2,this.boxMap[t][i].RefreshBox(h)),this.ScoreMgr.AddScoreFunc(Math.pow(2,h.flagNum));var r={};r.flagNum=h.flagNum,r.row=t,r.col=i,s.func(r)},h.MergeIntervalTime)},MergeNThreeL:function(e,t){var s=this;s.func=t,this.gameState=o.Merge,this.scheduleOnce(function(){var t=e.row,i=e.col,o=e.flagNum,h={};h.state=a.canMove,h.flagNum=0,this.boxMap[t][i-1].RefreshBox(h),this.boxMap[t][i].RefreshBox(h),this.boxMap[t+1][i].PlayMergeAni(c.NThreeL),o+2>11?(h.state=a.Fixed,h.flagNum=11,this.boxMap[t+1][i].RefreshBox(h)):(h.state=a.Fixed,h.flagNum=o+2,this.boxMap[t+1][i].RefreshBox(h)),this.ScoreMgr.AddScoreFunc(Math.pow(2,h.flagNum));var r={};r.flagNum=h.flagNum,r.row=t+1,r.col=i,s.func(r)},h.MergeIntervalTime)},MergeNThreeR:function(e,t){var s=this;s.func=t,this.gameState=o.Merge,this.scheduleOnce(function(){var t=e.row,i=e.col,o=e.flagNum,h={};h.state=a.canMove,h.flagNum=0,this.boxMap[t][i].RefreshBox(h),this.boxMap[t][i+1].RefreshBox(h),this.boxMap[t+1][i].PlayMergeAni(c.NThreeR),o+2>11?(h.state=a.Fixed,h.flagNum=11,this.boxMap[t+1][i].RefreshBox(h)):(h.state=a.Fixed,h.flagNum=o+2,this.boxMap[t+1][i].RefreshBox(h)),this.ScoreMgr.AddScoreFunc(Math.pow(2,h.flagNum));var r={};r.flagNum=h.flagNum,r.row=t+1,r.col=i,s.func(r)},h.MergeIntervalTime)},MergeNTwoD:function(e,t){var s=this;s.func=t,this.gameState=o.Merge,this.scheduleOnce(function(){var t=e.row,i=e.col,o=e.flagNum,h={};h.state=a.canMove,h.flagNum=0,this.boxMap[t][i].RefreshBox(h),this.boxMap[t+1][i].PlayMergeAni(c.TwoD),o+1>11?(h.state=a.Fixed,h.flagNum=11,this.boxMap[t+1][i].RefreshBox(h)):(h.state=a.Fixed,h.flagNum=o+1,this.boxMap[t+1][i].RefreshBox(h)),this.ScoreMgr.AddScoreFunc(Math.pow(2,h.flagNum));var r={};r.flagNum=h.flagNum,r.row=t+1,r.col=i,s.func(r)},h.MergeIntervalTime)},MergeNTwoL:function(e,t){var s=this;s.func=t,this.gameState=o.Merge,this.scheduleOnce(function(){var t=e.row,i=e.col,o=e.flagNum,h={};h.state=a.canMove,h.flagNum=0,this.boxMap[t][i-1].RefreshBox(h),this.boxMap[t][i].PlayMergeAni(c.TwoL),o+1>11?(h.state=a.Fixed,h.flagNum=11,this.boxMap[t][i].RefreshBox(h)):(h.state=a.Fixed,h.flagNum=o+1,this.boxMap[t][i].RefreshBox(h)),this.ScoreMgr.AddScoreFunc(Math.pow(2,h.flagNum));var r={};r.flagNum=h.flagNum,r.row=t,r.col=i,s.func(r)},h.MergeIntervalTime)},MergeNTwoR:function(e,t){var s=this;s.func=t,this.gameState=o.Merge,this.scheduleOnce(function(){var t=e.row,i=e.col,o=e.flagNum,h={};h.state=a.canMove,h.flagNum=0,this.boxMap[t][i+1].RefreshBox(h),this.boxMap[t][i].PlayMergeAni(c.TwoR),o+1>11?(h.state=a.Fixed,h.flagNum=11,this.boxMap[t][i].RefreshBox(h)):(h.state=a.Fixed,h.flagNum=o+1,this.boxMap[t][i].RefreshBox(h)),this.ScoreMgr.AddScoreFunc(Math.pow(2,h.flagNum));var r={};r.flagNum=h.flagNum,r.row=t,r.col=i,s.func(r)},h.MergeIntervalTime)},CheckCanMerge:function(e){var t=e.row,s=e.col,i=e.flagNum,a={};return a.mergeType=c.NULL,a.posBox=e,11==i?(this.gameState=o.Play,a):-1==i?0!=s&&s!=this.colsNum-1&&t!=this.rowsNum-1&&this.boxMap[t][s-1].flagNum==this.boxMap[t][s+1]&&this.boxMap[t+1][s].flagNum==this.boxMap[t][s-1].flagNum&&0!=this.boxMap[t][s-1].flagNum?(11==this.boxMap[t+1][s].flagNum?(a.mergeType=c.UPickD,a.posBox=e):(a.mergeType=c.UFour,a.posBox=e),a):0!=s&&s!=this.colsNum-1&&this.boxMap[t][s-1].flagNum==this.boxMap[t][s+1].flagNum&&0!=this.boxMap[t][s-1].flagNum&&11!=this.boxMap[t][s-1].flagNum?(a.mergeType=c.UThreeS,a.posBox=e,a):0!=s&&t!=this.rowsNum-1&&this.boxMap[t][s-1].flagNum==this.boxMap[t+1][s].flagNum&&0!=this.boxMap[t][s-1].flagNum?(11==this.boxMap[t][s-1].flagNum?(a.mergeType=c.UPickD,a.posBox=e):(a.mergeType=c.UThreeL,a.posBox=e),a):s!=this.colsNum-1&&t!=this.rowsNum-1&&this.boxMap[t][s+1].flagNum==this.boxMap[t+1][s].flagNum&&0!=this.boxMap[t][s+1].flagNum?(11==this.boxMap[t][s+1].flagNum?(a.mergeType=c.UPickD,a.posBox=e):(a.mergeType=c.UThreeR,a.posBox=e),a):t!=this.rowsNum-1&&0!=this.boxMap[t+1][s].flagNum?(11==this.boxMap[t+1][s].flagNum?(a.mergeType=c.UPickD,a.posBox=e):(a.mergeType=c.UTwoD,a.posBox=e),a):t==this.rowsNum-1?(a.mergeType=c.UPickD,a.posBox=e,a):a:0==i?a:0!=s&&s!=this.colsNum-1&&t!=this.rowsNum-1&&this.boxMap[t][s-1].flagNum==this.boxMap[t][s].flagNum&&this.boxMap[t][s+1].flagNum==this.boxMap[t][s].flagNum&&this.boxMap[t+1][s].flagNum==this.boxMap[t][s].flagNum?(a.mergeType=c.NFour,a.posBox=e,a):0!=s&&s!=this.colsNum-1&&this.boxMap[t][s-1].flagNum==this.boxMap[t][s].flagNum&&this.boxMap[t][s+1].flagNum==this.boxMap[t][s].flagNum?(a.mergeType=c.NThreeS,a.posBox=e,a):0!=s&&t!=this.rowsNum-1&&this.boxMap[t][s-1].flagNum==this.boxMap[t][s].flagNum&&this.boxMap[t+1][s].flagNum==this.boxMap[t][s].flagNum?(a.mergeType=c.NThreeL,a.posBox=e,a):s!=this.colsNum-1&&t!=this.rowsNum-1&&this.boxMap[t][s+1].flagNum==this.boxMap[t][s].flagNum&&this.boxMap[t+1][s].flagNum==this.boxMap[t][s].flagNum?(a.mergeType=c.NThreeR,a.posBox=e,a):0!=s&&this.boxMap[t][s-1].flagNum==this.boxMap[t][s].flagNum?(a.mergeType=c.TwoL,a.posBox=e,a):s!=this.colsNum-1&&this.boxMap[t][s+1].flagNum==this.boxMap[t][s].flagNum?(a.mergeType=c.TwoR,a.posBox=e,a):t!=this.rowsNum-1&&this.boxMap[t+1][s].flagNum==this.boxMap[t][s].flagNum?(a.mergeType=c.TwoD,a.posBox=e,a):a},checkCanMoveByDis:function(e,t){var s={canMove:!1,idx:-1};if(this.gameState!=o.Play)return s.canMove=!1,s;if(e==i.LEFT){if(0==this.checkPos[1])return s.canMove=!1,s;if(this.checkPos[1]-t<0){for(var a=-1,c=this.checkPos[1]-1;c>=0&&0==this.boxMap[this.checkPos[0]][c].flagNum;c--)a=c;return-1!=a?(s.canMove=!0,s.idx=a,s):(s.canMove=!1,s.idx=a,s)}if(this.checkPos[1]-t>=0){for(a=-1,c=this.checkPos[1]-1;c>=this.checkPos[1]-t&&0==this.boxMap[this.checkPos[0]][c].flagNum;c--)a=c;return-1!=a?(s.canMove=!0,s.idx=a,s):(s.canMove=!1,s.idx=a,s)}}if(e==i.RIGHT){if(this.checkPos[1]==this.colsNum-1)return s.canMove=!1,s;if(this.checkPos[1]+t>this.colsNum-1){for(a=-1,c=this.checkPos[1]+1;c<=this.colsNum-1&&0==this.boxMap[this.checkPos[0]][c].flagNum;c++)a=c;return-1!=a?(s.canMove=!0,s.idx=a,s):(s.canMove=!1,s.idx=a,s)}if(this.checkPos[1]+t<=this.colsNum-1){for(a=-1,c=this.checkPos[1]+1;c<=this.checkPos[1]+t&&0==this.boxMap[this.checkPos[0]][c].flagNum;c++)a=c;return-1!=a?(s.canMove=!0,s.idx=a,s):(s.canMove=!1,s.idx=a,s)}}if(e==i.DOWN){if(this.checkPos[0]==this.rowsNum-1)return s.canMove=!1,s;if(this.checkPos[0]+t>=this.rowsNum-1){cc.log("\u6ed1\u52a8\u8303\u56f4\u8d85\u51fa\u8fb9\u754c");for(a=-1,c=this.checkPos[0]+1;c<=this.rowsNum-1&&0==this.boxMap[c][this.checkPos[1]].flagNum;c++)a=c,cc.log("\u73b0\u5728\u5141\u8bb8\u7684\u4f4d\u7f6e\u662f\u591a\u5c11  =  "+c);return-1!=a?(s.canMove=!0,s.idx=a,s):(s.canMove=!1,s.idx=a,s)}if(this.checkPos[0]+t<this.rowsNum-1){cc.log("\u6ed1\u52a8\u8303\u56f4\u5185\u8fdb\u884c");for(a=-1,c=this.checkPos[0]+1;c<=this.checkPos[0]+t&&0==this.boxMap[c][this.checkPos[1]].flagNum;c++)a=c;return-1!=a?(s.canMove=!0,s.idx=a,s):(s.canMove=!1,s.idx=a,s)}}return s},checkCanMove:function(e){if(this.gameState!=o.Play)return!1;if(e==i.LEFT){if(0==this.checkPos[1])return!1;if(0!=this.boxMap[this.checkPos[0]][this.checkPos[1]-1].flagNum)return!1}if(e==i.RIGHT){if(this.checkPos[1]==this.colsNum-1)return!1;if(0!=this.boxMap[this.checkPos[0]][this.checkPos[1]+1].flagNum)return!1}if(e==i.DOWN){if(this.checkPos[0]==this.rowsNum-1)return!1;if(0!=this.boxMap[this.checkPos[0]+1][this.checkPos[1]].flagNum)return!1}return!0},getCheckPosBoxFlagNum:function(){return this.boxMap[this.checkPos[0]][this.checkPos[1]].flagNum},refreshCheckPos:function(e){this.checkPos[0]=e.x,this.checkPos[1]=e.y,h.setCheckPos(this.checkPos)},checkPosBeFixed:function(){if(this.checkPos[0]==this.rowsNum-1)this.gameState=o.Check,this.boxMap[this.checkPos[0]][this.checkPos[1]].RefreshState(a.Fixed),(e={}).row=this.checkPos[0],e.col=this.checkPos[1],e.flagNum=this.boxMap[this.checkPos[0]][this.checkPos[1]].flagNum,(t=this.CheckCanMerge(e)).mergeType==c.NULL?(this.gameState=o.Play,this.SpawnBox()):this.OperateMerge(t);else if(0!=this.boxMap[this.checkPos[0]+1][this.checkPos[1]].flagNum){var e,t;if(this.gameState=o.Check,this.boxMap[this.checkPos[0]][this.checkPos[1]].RefreshState(a.Fixed),(e={}).row=this.checkPos[0],e.col=this.checkPos[1],e.flagNum=this.boxMap[this.checkPos[0]][this.checkPos[1]].flagNum,(t=this.CheckCanMerge(e)).mergeType==c.NULL){if(0==this.checkPos[0])return this.gameState,o.Over,void this.scheduleOnce(function(){this.UIOverPanel.active=!0,cc.log("\u6e38\u620f\u7ed3\u675f")},h.ShowOverTime);this.gameState=o.Play,this.SpawnBox()}else this.OperateMerge(t)}},MoveBoxLeft:function(e){if(this.gameState==o.Play&&0!=this.checkCanMove(e)){var t=this.getCheckPosBoxFlagNum(),s={};s.state=a.canMove,s.flagNum=0,this.boxMap[this.checkPos[0]][this.checkPos[1]].RefreshBox(s);var i={};i.state=a.canMove,i.flagNum=t,this.boxMap[this.checkPos[0]][this.checkPos[1]-1].RefreshBox(i);var c={};c.x=this.checkPos[0],c.y=this.checkPos[1]-1,this.refreshCheckPos(c),this.checkPosBeFixed()}},MoveBoxLeftByDis:function(e,t){if(this.gameState==o.Play){var s=this.checkCanMoveByDis(e,t);if(0!=s.canMove){var i=this.getCheckPosBoxFlagNum(),c={};c.state=a.canMove,c.flagNum=0,this.boxMap[this.checkPos[0]][this.checkPos[1]].RefreshBox(c);var h={};h.state=a.canMove,h.flagNum=i,this.boxMap[this.checkPos[0]][s.idx].RefreshBox(h);var r={};r.x=this.checkPos[0],r.y=s.idx,this.refreshCheckPos(r),this.checkPosBeFixed()}}},MoveBoxRight:function(e){if(this.gameState==o.Play&&0!=this.checkCanMove(e)){var t=this.getCheckPosBoxFlagNum(),s={};s.state=a.canMove,s.flagNum=0,this.boxMap[this.checkPos[0]][this.checkPos[1]].RefreshBox(s);var i={};i.state=a.canMove,i.flagNum=t,this.boxMap[this.checkPos[0]][this.checkPos[1]+1].RefreshBox(i);var c={};c.x=this.checkPos[0],c.y=this.checkPos[1]+1,this.refreshCheckPos(c),this.checkPosBeFixed()}},MoveBoxRightByDis:function(e,t){if(this.gameState==o.Play){var s=this.checkCanMoveByDis(e,t);if(0!=s.canMove){var i=this.getCheckPosBoxFlagNum(),c={};c.state=a.canMove,c.flagNum=0,this.boxMap[this.checkPos[0]][this.checkPos[1]].RefreshBox(c);var h={};h.state=a.canMove,h.flagNum=i,this.boxMap[this.checkPos[0]][s.idx].RefreshBox(h);var r={};r.x=this.checkPos[0],r.y=s.idx,this.refreshCheckPos(r),this.checkPosBeFixed()}}},MoveBoxUp:function(e){this.gameState,o.Play},MoveBoxDown:function(e){if(this.gameState==o.Play&&0!=this.checkCanMove(e)){var t=this.getCheckPosBoxFlagNum(),s={};s.state=a.canMove,s.flagNum=0,this.boxMap[this.checkPos[0]][this.checkPos[1]].RefreshBox(s);var i={};i.state=a.canMove,i.flagNum=t,this.boxMap[this.checkPos[0]+1][this.checkPos[1]].RefreshBox(i);var c={};c.x=this.checkPos[0]+1,c.y=this.checkPos[1],this.refreshCheckPos(c),this.checkPosBeFixed()}},MoveBoxDownByDis:function(e,t){if(this.gameState==o.Play){var s=this.checkCanMoveByDis(e,t);if(cc.log("\u4e0b\u6ed1\u8ddd\u79bb ===== "+t),cc.log(s.canMove+"  \u662f\u5426\u53ef\u4ee5\u4e0b\u6ed1\u5230\u4f4d\u7f6e   =====  "+s.idx),0!=s.canMove){var i=this.getCheckPosBoxFlagNum(),c={};c.state=a.canMove,c.flagNum=0,this.boxMap[this.checkPos[0]][this.checkPos[1]].RefreshBox(c);var h={};h.state=a.canMove,h.flagNum=i,this.boxMap[s.idx][this.checkPos[1]].RefreshBox(h);var r={};r.x=s.idx,r.y=this.checkPos[1],this.refreshCheckPos(r),this.checkPosBeFixed()}}},addListeners:function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouched,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKey,this)},onTouched:function(e){var t=e.getStartLocation(),s=e.getLocation(),o=s.x-t.x,a=s.y-t.y;Math.abs(o)>Math.abs(a)?o>0?o>5&&this.MoveBoxRight(i.RIGHT):o<0&&o<-5&&this.MoveBoxLeft(i.LEFT):a>5||a<0&&this.MoveBoxDownByDis(i.DOWN,6)},onKey:function(e){switch(e.keyCode){case cc.macro.KEY.up:case cc.macro.KEY.w:break;case cc.macro.KEY.down:case cc.macro.KEY.s:this.MoveBoxDown(i.DOWN);break;case cc.macro.KEY.left:case cc.macro.KEY.a:this.MoveBoxLeft(i.LEFT);break;case cc.macro.KEY.right:case cc.macro.KEY.d:this.MoveBoxRight(i.RIGHT)}},ClearBoard:function(){for(var e=this.rowsNum-1;e>=0;e--)for(var t=0;t<this.colsNum;t++)this.boxMap[e][t].RefreshToInitState()},SkillTickThreeBox:function(){}});t.exports=l,cc._RF.pop()},{DIR:"DIR",MergeType:"MergeType",NextBoxDataListSpawn:"NextBoxDataListSpawn",ScoreMgr:"ScoreMgr",TZBox:"TZBox",TZGameState:"TZGameState",TZGlobalData:"TZGlobalData",TZState:"TZState"}],TZBox:[function(e,t,s){"use strict";cc._RF.push(t,"dc562TR+71HJ7EwKkI8/aXj","TZBox");var i=e("TZState"),o=e("TZGlobalData"),a=e("MergeType"),c=cc.Class({extends:cc.Component,properties:{Atlas:cc.SpriteAtlas,Sp:cc.Sprite,MergeUpNode:cc.Node,MergeLNode:cc.Node,MergeRNode:cc.Node,MergeULNode:cc.Node,MergeURNode:cc.Node,MergeMNode:cc.Node,MergeURLNode:cc.Node,spUp:[cc.Sprite],spUL:[cc.Sprite],spUR:[cc.Sprite],spL:[cc.Sprite],spR:[cc.Sprite],spEnd:cc.Sprite,state:{default:i.Init,type:i},flagNum:0,mergeUpSp:0,mergeULRSp:0,anim:cc.Animation,animaScore:cc.Animation,ScoreGetLbl:cc.Label,MergeExploreObj:cc.Node,effectObj:cc.Node,selected:!1,posX:-1,posY:-1,ScoreNum:0},PlayMergeAni:function(e){cc.Mgr.AudioMgr.playSFX("coin"),this.MergeURLNode.active=!1,this.MergeUpNode.active=!1,this.MergeLNode.active=!1,this.MergeURNode.active=!1,this.MergeULNode.active=!1,this.MergeRNode.active=!1,this.MergeMNode.active=!1,e!=a.TwoD&&e!=a.UTwoD||(this.mergeUpSp=this.flagNum,this.ScoreNum=this.flagNum+1,this.MergeUpNode.active=!0,this.anim.play("MergeD")),e==a.TwoL&&(this.mergeULRSp=this.flagNum,this.ScoreNum=this.flagNum+1,this.MergeLNode.active=!0,this.anim.play("MergeL")),e==a.TwoR&&(this.mergeULRSp=this.flagNum,this.ScoreNum=this.flagNum+1,this.MergeRNode.active=!0,this.anim.play("MergeR")),e!=a.NThreeS&&e!=a.UThreeS||(this.mergeULRSp=this.flagNum,this.ScoreNum=this.flagNum+2,this.MergeMNode.active=!0,this.anim.play("MergeM")),e!=a.NThreeL&&e!=a.UThreeL||(this.mergeULRSp=this.flagNum,this.mergeUpSp=this.flagNum+1,this.ScoreNum=this.flagNum+2,this.MergeULNode.active=!0,this.anim.play("MergeUL")),e!=a.NThreeR&&e!=a.UThreeR||(this.mergeULRSp=this.flagNum,this.mergeUpSp=this.flagNum+1,this.ScoreNum=this.flagNum+2,this.MergeURNode.active=!0,this.anim.play("MergeUR")),e!=a.UFour&&e!=a.NFour||(this.mergeULRSp=this.flagNum,this.mergeUpSp=this.flagNum+1,this.ScoreNum=this.flagNum+3,this.MergeURLNode.active=!0,this.anim.play("MergeULR"))},InitBox:function(e,t){this.state=i.canMove;var s="Sp_"+Math.pow(2,this.flagNum);this.Sp.spriteFrame=this.Atlas.getSpriteFrame(s),this.selected=!1,this.posX=e,this.posY=t},SpawnBox:function(e){this.selected=!1,this.state=i.canMove;Math.floor(6*Math.random());Math.random(),cc.log("\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u76d2\u5b50 "+e),this.flagNum=e;var t="Sp_"+Math.floor(Math.pow(2,this.flagNum));this.Sp.spriteFrame=this.Atlas.getSpriteFrame(t)},RefreshBox:function(e){this.state=e.state,this.flagNum=e.flagNum;var t="Sp_"+Math.floor(Math.pow(2,this.flagNum));this.Sp.spriteFrame=this.Atlas.getSpriteFrame(t)},RefreshBoxAfterChange:function(e){this.flagNum=e.flagNum,this.selected=!1;var t="Sp_"+Math.floor(Math.pow(2,this.flagNum));this.Sp.spriteFrame=this.Atlas.getSpriteFrame(t),this.Sp.setState(0)},RefreshToInitState:function(){this.state=i.canMove,this.flagNum=0;var e="Sp_"+Math.floor(Math.pow(2,this.flagNum));this.Sp.spriteFrame=this.Atlas.getSpriteFrame(e)},RefreshState:function(e){this.state=e},PlayChuiZiEffect:function(){this.posX!=o.checkPos[0]||this.posY!=o.checkPos[1]?0!=this.flagNum&&1==o.UsingSkill&&1==o.SkillHammer&&this.anim.play("TZChuiZi"):cc.log("\u4e0b\u843d\u7684\u76d2\u5b50\u4e0d\u80fd\u6267\u884c\u6280\u80fd")},GoDoubleFlagNum:function(){if(this.posX!=o.checkPos[0]||this.posY!=o.checkPos[1])if(10!=this.flagNum){if(0!=this.flagNum&&1==o.UsingSkill&&1==o.SkillDouble){this.flagNum+=1;var e="Sp_"+Math.pow(2,this.flagNum);this.Sp.spriteFrame=this.Atlas.getSpriteFrame(e),cc.director.emit("UsingDouble",{})}}else cc.log("\u4e0d\u80fd\u5347\u7ea7\u52302048");else cc.log("\u4e0b\u843d\u7684\u76d2\u5b50\u4e0d\u80fd\u6267\u884c\u6280\u80fd")},ExhangeBox:function(){this.posX!=o.checkPos[0]||this.posY!=o.checkPos[1]?0!=this.flagNum&&1==o.UsingSkill&&1==o.SkillChange&&(0==this.selected?1!=o.selectedNum&&0!=o.selectedNum||(o.selectedNum+=1,this.selected=!0,this.Sp.setState(1)):1==this.selected&&1==o.selectedNum&&(o.selectedNum-=1,this.selected=!1,this.Sp.setState(0)),cc.director.emit("SkillChange",{})):cc.log("\u4e0b\u843d\u7684\u76d2\u5b50\u4e0d\u80fd\u6267\u884c\u6280\u80fd")},HideChuiZi:function(){this.effectObj.active=!1,this.RefreshToInitState(),cc.log("\u4f7f\u7528\u5b8c\u4e86\u9524\u5b50"),cc.director.emit("UsingChuiZi",{})},ShowChuiZi:function(){this.effectObj.active=!0},SetSpUp:function(){cc.log("++++++++++++++++++++++++++++++++++++++");for(var e=this.spUp.length-1;e>=0;e--){var t="Sp_"+Math.pow(2,this.mergeUpSp);this.spUp[e].spriteFrame=this.Atlas.getSpriteFrame(t)}},SetSpL:function(){for(var e=this.spL.length-1;e>=0;e--){var t="Sp_"+Math.pow(2,this.mergeULRSp);this.spL[e].spriteFrame=this.Atlas.getSpriteFrame(t)}for(e=this.spUp.length-1;e>=0;e--){t="Sp_"+Math.pow(2,this.mergeULRSp);this.spUp[e].spriteFrame=this.Atlas.getSpriteFrame(t)}},SetSpR:function(){for(var e=this.spR.length-1;e>=0;e--){var t="Sp_"+Math.pow(2,this.mergeULRSp);this.spR[e].spriteFrame=this.Atlas.getSpriteFrame(t)}for(e=this.spUp.length-1;e>=0;e--){t="Sp_"+Math.pow(2,this.mergeULRSp);this.spUp[e].spriteFrame=this.Atlas.getSpriteFrame(t)}},SetSpU:function(){cc.log("++++++++++++++++++++++++++++++++++++++");for(var e=this.spUp.length-1;e>=0;e--){var t="Sp_"+Math.pow(2,this.mergeUpSp);this.spUp[e].spriteFrame=this.Atlas.getSpriteFrame(t)}},SetSpUL:function(){for(var e=this.spUL.length-1;e>=0;e--){var t="Sp_"+Math.pow(2,this.mergeULRSp);this.spUL[e].spriteFrame=this.Atlas.getSpriteFrame(t)}for(e=this.spUp.length-1;e>=0;e--){t="Sp_"+Math.pow(2,this.mergeULRSp);this.spUp[e].spriteFrame=this.Atlas.getSpriteFrame(t)}},SetSpUR:function(){for(var e=this.spUR.length-1;e>=0;e--){var t="Sp_"+Math.pow(2,this.mergeULRSp);this.spUR[e].spriteFrame=this.Atlas.getSpriteFrame(t)}for(e=this.spUp.length-1;e>=0;e--){t="Sp_"+Math.pow(2,this.mergeULRSp);this.spUp[e].spriteFrame=this.Atlas.getSpriteFrame(t)}},SetSpURL:function(){for(var e=this.spUR.length-1;e>=0;e--){var t="Sp_"+Math.pow(2,this.mergeULRSp);this.spUR[e].spriteFrame=this.Atlas.getSpriteFrame(t)}for(e=this.spUL.length-1;e>=0;e--){t="Sp_"+Math.pow(2,this.mergeULRSp);this.spUL[e].spriteFrame=this.Atlas.getSpriteFrame(t)}for(e=this.spUp.length-1;e>=0;e--){t="Sp_"+Math.pow(2,this.mergeULRSp);this.spUp[e].spriteFrame=this.Atlas.getSpriteFrame(t)}},SetSpLR:function(){for(var e=this.spL.length-1;e>=0;e--){var t="Sp_"+Math.pow(2,this.mergeULRSp);this.spL[e].spriteFrame=this.Atlas.getSpriteFrame(t)}for(e=this.spR.length-1;e>=0;e--){t="Sp_"+Math.pow(2,this.mergeULRSp);this.spR[e].spriteFrame=this.Atlas.getSpriteFrame(t)}},PlayMergeEffect:function(){cc.log("========================++++++++++++++++++++++======================"),this.ScoreGetLbl.string=Math.pow(2,this.ScoreNum),this.ScoreGetLbl.node.active=!0,this.MergeExploreObj.active=!0,this.animaScore.play("ScoreEffect")},SetSpM:function(){},EndScoreExplore:function(){cc.log("+++++++++++++++++eeeeee+++++++++++++++++++++"),this.ScoreGetLbl.node.active=!1,this.MergeExploreObj.active=!1,this.MergeURLNode.active=!1,this.MergeUpNode.active=!1,this.MergeLNode.active=!1,this.MergeURNode.active=!1,this.MergeULNode.active=!1,this.MergeRNode.active=!1,this.MergeMNode.active=!1}});t.exports=c,cc._RF.pop()},{MergeType:"MergeType",TZGlobalData:"TZGlobalData",TZState:"TZState"}],TZGameStart:[function(e,t,s){"use strict";cc._RF.push(t,"66186V6WyxLOoQajP1CXp0M","TZGameStart"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){(function(){cc.Mgr={};var t=e("AudioMgr");cc.Mgr.AudioMgr=new t,cc.Mgr.AudioMgr.init();var s=e("TZUserData");cc.Mgr.UserData=new s})(),cc.Mgr.UserData.initData()},start:function(){cc.Mgr.AudioMgr.playBGM("bgm")}}),cc._RF.pop()},{AudioMgr:"AudioMgr",TZUserData:"TZUserData"}],TZGameState:[function(e,t,s){"use strict";cc._RF.push(t,"4e94eUVre5ONLeCXh2HORrT","TZGameState");var i=cc.Enum({Wait:0,Play:1,Over:2,Pause:3,Merge:4,Effect:5,SlowDown:6,Check:7});t.exports=i,cc._RF.pop()},{}],TZGlobalData:[function(e,t,s){"use strict";cc._RF.push(t,"91825L+iQhKh5YgoCe74G8b","TZGlobalData");var i=cc.Class({extends:cc.Component,statics:{MergeIntervalTime:.5,WaitSpawnBoxTime:.4,ShowOverTime:.25,SkillInterTime:.3,MergeLaterTime:.4,UsingSkill:!1,SkillDouble:!1,SkillHammer:!1,SkillChange:!1,selectedNum:0,checkPos:[],clearCheckPos:function(){this.checkPos[0]=-1,this.checkPos[1]=-1},clearData:function(){this.UsingSkill=!1,this.SkillDouble=!1,this.SkillHammer=!1,this.SkillChange=!1,this.selectedNum=0},setCheckPos:function(e){this.checkPos[0]=e[0],this.checkPos[1]=e[1]}}});t.exports=i,cc._RF.pop()},{}],TZSkillType:[function(e,t,s){"use strict";cc._RF.push(t,"507a6BgGjhOzpELi+iwmMRd","TZSkillType");var i=cc.Enum({Hammer:1,ExChange:2,Double:3});t.exports=i,cc._RF.pop()},{}],TZState:[function(e,t,s){"use strict";cc._RF.push(t,"0ffaa1AClVJbqFI6qIvNp7V","TZState");var i=cc.Enum({Init:0,canMove:1,Fixed:2});t.exports=i,cc._RF.pop()},{}],TZUIMgr:[function(e,t,s){"use strict";cc._RF.push(t,"0ab09eHiTRF1ZZwioXz6fSl","TZUIMgr");var i=e("TZBoard"),o=e("TZGameState"),a=e("ScoreMgr"),c=e("TipPanel"),h=e("TZGlobalData"),r=e("NextBoxDataListSpawn"),n=cc.Class({extends:cc.Component,properties:{ScoreMgr:a,TzGameBoard:i,UIStartPanel:cc.Node,UIOverPanel:cc.Node,UIAtlas:cc.SpriteAtlas,PauseSp:cc.Sprite,TipPanel:c,NextDataList:r},UseTipSkill:function(){cc.Mgr.AudioMgr.playSFX("click"),this.NextDataList.SetNextListActive(!0)},UseCrackBoxSkill:function(){if(cc.Mgr.AudioMgr.playSFX("click"),1==h.UsingSkill&&0==h.SkillHammer){var e={text:"\u6280\u80fd\u4e0d\u80fd\u91cd\u590d\u9009\u7528"};return this.TipPanel.node.active=!0,void this.TipPanel.ShowPanel(e)}if(1==h.UsingSkill&&1==h.SkillHammer)return h.UsingSkill=!1,h.SkillHammer=!1,void this.ResumeGame();this.TzGameBoard.OffTouchEventListener(),this.PauseGame(),h.SkillHammer=!0,h.UsingSkill=!0},UseDoubleBoxSkill:function(){if(cc.Mgr.AudioMgr.playSFX("click"),1==h.UsingSkill&&0==h.SkillDouble){var e={text:"\u6280\u80fd\u4e0d\u80fd\u91cd\u590d\u9009\u7528"};return this.TipPanel.node.active=!0,void this.TipPanel.ShowPanel(e)}if(1==h.UsingSkill&&1==h.SkillDouble)return h.UsingSkill=!1,h.SkillDouble=!1,void this.ResumeGame();this.TzGameBoard.OffTouchEventListener(),h.UsingSkill=!0,h.SkillDouble=!0,this.PauseGame()},UsingChangeBoxSkill:function(){if(cc.Mgr.AudioMgr.playSFX("click"),1==h.UsingSkill&&0==h.SkillChange){var e={text:"\u6280\u80fd\u4e0d\u80fd\u91cd\u590d\u9009\u7528"};return this.TipPanel.node.active=!0,void this.TipPanel.ShowPanel(e)}if(1==h.UsingSkill&&1==h.SkillChange)return h.UsingSkill=!1,h.SkillChange=!1,void this.ResumeGame();this.TzGameBoard.OffTouchEventListener(),h.UsingSkill=!0,h.SkillChange=!0,this.PauseGame()},StartPlay:function(){cc.Mgr.AudioMgr.playSFX("click"),this.ScoreMgr.ResetScore(),this.UIStartPanel.active=!1,h.clearCheckPos(),h.clearData(),h.UsingSkill=!1,this.TzGameBoard.gameState=o.Play,this.TzGameBoard.SpawnBox()},ReStartPlay:function(){cc.Mgr.AudioMgr.playSFX("click"),this.ScoreMgr.ResetScore(),this.UIOverPanel.active=!1,h.clearCheckPos(),h.clearData(),h.UsingSkill=!1,this.TzGameBoard.ClearBoard(),this.TzGameBoard.gameState=o.Play,this.TzGameBoard.SpawnBox()},PauseGame:function(){this.TzGameBoard.gameState=o.Pause,this.PauseSp.spriteFrame=this.UIAtlas.getSpriteFrame("\u53f3\u7bad\u5934")},ResumeGame:function(){this.TzGameBoard.gameState=o.Play,this.PauseSp.spriteFrame=this.UIAtlas.getSpriteFrame("\u6682\u505c")},SetGamePause:function(){this.TzGameBoard.gameState==o.Play?(this.TzGameBoard.gameState=o.Pause,this.PauseSp.spriteFrame=this.UIAtlas.getSpriteFrame("\u53f3\u7bad\u5934")):this.TzGameBoard.gameState==o.Pause&&(this.TzGameBoard.gameState=o.Play,this.PauseSp.spriteFrame=this.UIAtlas.getSpriteFrame("\u6682\u505c"))},GotoLooby:function(){this.TipPanel.node.active=!0;var e={text:"\u5927\u5385\u8fd8\u6ca1\u505a\u597d,\u6bcd\u9e21\u5440"};this.TipPanel.ShowPanel(e)},ShareGame:function(){this.TipPanel.node.active=!0;var e={text:"\u5206\u4eab\u8fd8\u6ca1\u505a\u597d,\u6bcd\u9e21\u5440"};this.TipPanel.ShowPanel(e)},VoiceSetting:function(){1==cc.Mgr.AudioMgr.musicState?cc.Mgr.AudioMgr.pauseAll():(cc.Mgr.AudioMgr.resumeAll(),cc.Mgr.AudioMgr.playSFX("click"))}});t.exports=n,cc._RF.pop()},{NextBoxDataListSpawn:"NextBoxDataListSpawn",ScoreMgr:"ScoreMgr",TZBoard:"TZBoard",TZGameState:"TZGameState",TZGlobalData:"TZGlobalData",TipPanel:"TipPanel"}],TZUserData:[function(e,t,s){"use strict";cc._RF.push(t,"32c44mb3KNI5bNPjbePtfUZ","TZUserData");var i=e("TZSkillType"),o=cc.Class({extends:cc.Component,properties:{ExChangeNum:cc.Integer,DoubleNum:cc.Integer,HammerNum:cc.Integer,HighScore:cc.Integer},initData:function(){this.ExChangeNum=2,this.DoubleNum=2,this.HammerNum=2,cc.log("\u8349\u6ce5\u9a6c\u7684\u6570\u503c = "+cc.sys.localStorage.getItem("tz_highscore")),null!=cc.sys.localStorage.getItem("tz_highscore")?this.HighScore=cc.sys.localStorage.getItem("tz_highscore"):this.HighScore=0},refreshSkillNum:function(e,t){switch(e){case i.Hammer:this.HammerNum+=t;break;case i.ExChange:this.ExChangeNum+=t;break;case i.Double:this.DoubleNum+=t}},useSkill:function(e){return e==i.Hammer&&this.HammerNum>=1?(this.HammerNum-=1,!0):e==i.Double&&this.DoubleNum>=1?(this.DoubleNum-=1,!0):e==i.ExChange&&this.ExChangeNum>=1&&(this.ExChangeNum-=1,!0)},getHighScore:function(){return this.HighScore},refreshHighScore:function(e){e>this.HighScore&&(this.HighScore=e)},SaveData:function(){cc.sys.localStorage.setItem("tz_highscore",this.HighScore)}});t.exports=o,cc._RF.pop()},{TZSkillType:"TZSkillType"}],TipPanel:[function(e,t,s){"use strict";cc._RF.push(t,"5db2d1mfk9IP7bZHG4YWjiC","TipPanel");var i=cc.Class({extends:cc.Component,properties:{TipLbl:cc.Label},ShowPanel:function(e){this.TipLbl.string=e.text},ClosePanel:function(){cc.Mgr.AudioMgr.playSFX("click"),this.node.active=!1}});t.exports=i,cc._RF.pop()},{}]},{},["AudioMgr","DIR","EffectNode","GameOverPanel","MergeType","NextBoxDataListSpawn","OverPanel","PausePanel","RankItem","RankPanel","RebornPanel","RewardPanel","ScoreEnum","ScoreMgr","SkillState","TZBoard","TZBox","TZGameStart","TZGameState","TZGlobalData","TZSkillType","TZState","TZUIMgr","TZUserData","TipPanel"]);