__require=function t(n,e,i){function o(s,c){if(!e[s]){if(!n[s]){var a=s.split("/");if(a=a[a.length-1],!n[a]){var h="function"==typeof __require&&__require;if(!c&&h)return h(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+s+"'")}}var u=e[s]={exports:{}};n[s][0].call(u.exports,function(t){return o(n[s][1][t]||t)},u,u.exports,t,n,e,i)}return e[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<i.length;s++)o(i[s]);return o}({GotoWeb:[function(t,n,e){"use strict";cc._RF.push(n,"0e845Dln2xCx4rDcP8cWyhz","GotoWeb"),cc.Class({extends:cc.Component,properties:{},start:function(){},gotoWeb:function(){cc.sys.openURL("https://alexdoninic.github.io/to_Miss_Zhang/")}}),cc._RF.pop()},{}],NoticeText:[function(t,n,e){"use strict";cc._RF.push(n,"8bec4K7QRJA57Pryls+SRSb","NoticeText"),cc.director.NoticeText={1:"\u5b8c\u7f8e",2:"\u5389\u5bb3\u4e86",3:"\u4f60\u5f88\u5f3a",4:"\u7b80\u76f4\u4e86",5:"\u518d\u63a5\u518d\u5389",6:"\u4f60\u53ef\u4ee5\u4e0a\u5929"},cc._RF.pop()},{}],backgroundLoader:[function(t,n,e){"use strict";cc._RF.push(n,"1ba569pWT1NW4FvgybtQ/YJ","backgroundLoader"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){var t="bg"+((100*Math.random()|0)%3+1),n=this.node.getComponent(cc.Sprite);cc.loader.loadRes("hero/"+t,cc.SpriteFrame,function(t,e){n.spriteFrame=e}),cc.log(t)}}),cc._RF.pop()},{}],btn:[function(t,n,e){"use strict";cc._RF.push(n,"2da0dBTR9tDEoDKa8CshNX4","btn");var i=t("landMaker");cc.Class({extends:cc.Component,properties:{},onLoad:function(){},buttonClicked:function(){i.restart()},gameStart:function(){cc.director.loadScene("MainGameScene")}}),cc._RF.pop()},{landMaker:"landMaker"}],landMaker:[function(t,n,e){"use strict";cc._RF.push(n,"d0079DKriBNl693joESFHLy","landMaker");var i=t("spriteCreator"),o=t("perfectLabel"),r=t("storageManager"),s=new(t("state-machine"))({data:{gameDirector:null},init:"stand",transitions:[{name:"stickLengthen",from:"stand",to:"stickLengthened"},{name:"heroTick",from:"stickLengthened",to:"heroTicked"},{name:"stickFall",from:"heroTicked",to:"stickFalled"},{name:"heroMoveToLand",from:"stickFalled",to:"heroMovedToLand"},{name:"landMove",from:"heroMovedToLand",to:"stand"},{name:"heroMoveToStickEnd",from:"stickFalled",to:"heroMovedToStickEnd"},{name:"heroDown",from:"heroMovedToStickEnd",to:"heroDowned"},{name:"gameOver",from:"heroDowned",to:"end"},{name:"restart",from:"end",to:"stand"}],methods:{onLeaveHeroTicked:function(){c.unregisterEvent()},onStickLengthen:function(){c.stickLengthen=!0,c.stick=c.createStick(),c.stick.x=c.hero.x+c.hero.width*(1-c.hero.anchorX)+c.stick.width*c.stick.anchorX,c.hero.getComponent(cc.Animation).play("heroPush")},onHeroTick:function(){c.stickLengthen=!1,c.hero.getComponent(cc.Animation).play("heroTick")},onStickFall:function(){var t=cc.rotateBy(.5,90);t.easing(cc.easeIn(3));var n=cc.callFunc(function(){var t=c.stick.height-c.stick.width*c.stick.anchorX;t<c.currentLandRange||t>c.currentLandRange+c.secondLand.width?s.heroMoveToStickEnd():(s.heroMoveToLand(),t>c.currentLandRange+c.secondLand.width/2-5&&t<c.currentLandRange+c.secondLand.width/2+5?(c.perfect++,c.getScore(80*c.perfect),c.perfectLabel.getComponent(o).showPerfect(c.perfect)):c.perfect=0)}),e=cc.sequence(t,n);c.stick.runAction(e)},onHeroMoveToLand:function(){var t=c.hero.getComponent(cc.Animation),n=cc.callFunc(function(){t.stop("heroRun"),c.getScore(),s.landMove()});t.play("heroRun"),c.heroMove(c.hero,{length:c.currentLandRange+c.secondLand.width,callFunc:n})},onLandMove:function(){var t=cc.callFunc(function(){c.registerEvent()});c.landCreateAndMove(t)},onHeroMoveToStickEnd:function(){var t=c.hero.getComponent(cc.Animation),n=cc.callFunc(function(){t.stop("heroRun"),s.heroDown()});t.play("heroRun"),c.heroMove(c.hero,{length:c.stick.height,callFunc:n})},onHeroDown:function(){var t=cc.callFunc(function(){s.gameOver()});c.stickAndHeroDownAction(t)},onGameOver:function(){c.overLabel.node.active=!0},onRestart:function(){cc.director.loadScene("MainGameScene")}}}),c=null;cc.Class({extends:cc.Component,properties:{landRange:cc.v2(20,300),landWidth:cc.v2(20,200),hero:cc.Node,firstLand:cc.Node,secondLand:cc.Node,moveDuration:.5,stickSpeed:400,heroMoveSpeed:400,stickWidth:6,canvas:cc.Node,scoreLabel:cc.Label,hightestScoreLabel:cc.Label,overLabel:cc.Label,perfectLabel:cc.Node},onLoad:function(){c=this,this.runLength=0,this.stick=null,this.stickLengthen=!1,this.score=0,this.perfect=0,this.currentLandRange=0,this.heroWorldPosX=0,this.changeHightestScoreLabel(),this.createNewLand();var t=this.getLandRange();this.heroWorldPosX=this.firstLand.width-(1-this.hero.anchorX)*this.hero.width-this.stickWidth,this.secondLand.setPosition(t+this.firstLand.width,0),this.registerEvent(),c.hero.getComponent(cc.Animation).on("stop",function(t){"heroTick"==t.target.name&&s.stickFall()})},registerEvent:function(){this.canvas.on(cc.Node.EventType.TOUCH_START,this.touchStart.bind(this),this.node),this.canvas.on(cc.Node.EventType.TOUCH_END,this.touchEnd.bind(this),this.node),this.canvas.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel.bind(this),this.node),console.log("on")},unregisterEvent:function(){this.canvas.targetOff(this.node),console.log("off")},update:function(t){this.stickLengthen&&(this.stick.height+=t*this.stickSpeed)},touchStart:function(t){s.stickLengthen(),cc.log("touchStart")},touchEnd:function(t){s.heroTick(),cc.log("touchEnd")},touchCancel:function(){this.touchEnd(),cc.log("touchCancel")},stickAndHeroDownAction:function(t){var n=cc.rotateBy(.5,90);n.easing(cc.easeIn(3)),this.stick.runAction(n);var e=cc.moveBy(.5,cc.p(0,-300-this.hero.height));e.easing(cc.easeIn(3));var i=cc.sequence(e,t);this.hero.runAction(i)},heroMove:function(t,n){var e=n.length/this.heroMoveSpeed,i=cc.moveBy(e,cc.p(n.length,0));if(n.callFunc){var o=cc.sequence(i,n.callFunc);this.hero.runAction(o)}else this.hero.runAction(i)},landCreateAndMove:function(t){var n=cc.director.getWinSize(),e=this.currentLandRange+this.secondLand.width;this.runLength+=e;var i=cc.moveBy(this.moveDuration,cc.p(-e,0));this.node.runAction(i),this.firstLand=this.secondLand,this.createNewLand();var o=this.getLandRange();this.secondLand.setPosition(this.runLength+n.width,0);var r=n.width-o-this.heroWorldPosX-this.hero.width*this.hero.anchorX-this.stickWidth,s=cc.moveBy(this.moveDuration,cc.p(-r,0)),c=cc.sequence(s,t);this.secondLand.runAction(c)},createStick:function(){cc.log("sc");var t=i.createStick(this.stickWidth);return t.parent=this.node,t},createNewLand:function(){this.secondLand=i.createNewLand(this.getLandWidth()),this.secondLand.parent=this.node},getScore:function(t){this.score+=t||40,r.getHighestScore()<this.score&&(r.setHighestScore(this.score),this.changeHightestScoreLabel()),this.scoreLabel.string="\u5f97\u5206:"+this.score,this.score>=520&&cc.director.loadScene("SpecialScene")},changeHightestScoreLabel:function(){this.hightestScoreLabel.string="\u6700\u9ad8\u5206:"+r.getHighestScore()},getLandRange:function(){this.currentLandRange=this.landRange.x+(this.landRange.y-this.landRange.x)*Math.random();var t=cc.director.getWinSize();return t.width<this.currentLandRange+this.heroWorldPosX+this.hero.width+this.secondLand.width&&(this.currentLandRange=t.width-this.heroWorldPosX-this.hero.width-this.secondLand.width),this.currentLandRange},getLandWidth:function(){return this.landWidth.x+(this.landWidth.y-this.landWidth.x)*Math.random()}}),n.exports=s,cc._RF.pop()},{perfectLabel:"perfectLabel",spriteCreator:"spriteCreator","state-machine":"state-machine",storageManager:"storageManager"}],perfectLabel:[function(t,n,e){"use strict";cc._RF.push(n,"68d3cmKQRxMxJwM5MfqZrPh","perfectLabel"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.anim=this.node.getComponent(cc.Animation),this.label=this.node.getComponent(cc.Label)},showPerfect:function(t){this.label.string="\u5b8c\u7f8e X "+t;var n=cc.fadeIn(.1),e=cc.moveBy(1,cc.p(0,0)),i=cc.fadeOut(0),o=cc.sequence(n,e,i);this.node.runAction(o)},removeLabel:function(){cc.log("removeLabel")},showLabel:function(){cc.log("showLabel")}}),cc._RF.pop()},{}],spriteCreator:[function(t,n,e){"use strict";cc._RF.push(n,"4310ceORutFCrUEBpToyuTd","spriteCreator");var i=function(){var t=null;return{createNewLand:function(n){var e=new cc.Node("Land");e.anchorX=0,e.anchorY=0;var i=e.addComponent(cc.Sprite);i.sizeMode=cc.Sprite.SizeMode.CUSTOM,e.color=cc.Color.BLACK,e.height=300,e.width=n;var o=new cc.Node("Red Land");o.anchorY=1;var r=o.addComponent(cc.Sprite);return r.sizeMode=cc.Sprite.SizeMode.CUSTOM,o.color=cc.Color.RED,o.parent=e,o.height=10,o.width=10,o.setPosition(e.width/2,e.height),t?(i.spriteFrame=t,r.spriteFrame=t):cc.loader.loadRes("hero/blank",cc.SpriteFrame,function(n,e){i.spriteFrame=e,r.spriteFrame=e,t=e}),e.center=o,e},createStick:function(n){var e=new cc.Node("stick");e.anchorY=0,e.y=300;var i=e.addComponent(cc.Sprite);return i.sizeMode=cc.Sprite.SizeMode.CUSTOM,i.spriteFrame=t,e.color=cc.Color.BLACK,e.width=n,e.height=0,e}}}();n.exports=i,cc._RF.pop()},{}],"state-machine":[function(t,n,e){"use strict";cc._RF.push(n,"5b87f0RBv9JUIU1APm/AFrF","state-machine");var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(t,o){"object"===(void 0===e?"undefined":i(e))&&"object"===(void 0===n?"undefined":i(n))?n.exports=o():"function"==typeof define&&define.amd?define("StateMachine",[],o):"object"===(void 0===e?"undefined":i(e))?e.StateMachine=o():t.StateMachine=o()})(void 0,function(){return function(t){var n={};function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=6)}([function(t,n,e){t.exports=function(t,n){var e,i,o;for(e=1;e<arguments.length;e++)for(o in i=arguments[e])i.hasOwnProperty(o)&&(t[o]=i[o]);return t}},function(t,n,e){var i=e(0);t.exports={build:function(t,n){var e,o,r,s=n.plugins;for(e=0,o=s.length;e<o;e++)(r=s[e]).methods&&i(t,r.methods),r.properties&&Object.defineProperties(t,r.properties)},hook:function(t,n,e){var i,o,r,s,c=t.config.plugins,a=[t.context];for(e&&(a=a.concat(e)),i=0,o=c.length;i<o;i++)s=c[i],(r=c[i][n])&&r.apply(s,a)}}},function(t,n,e){t.exports=function(t){var n,e=t.split(/[_-]/),i=e[0];for(n=1;n<e.length;n++)i=i+e[n].charAt(0).toUpperCase()+e[n].substring(1);return i}},function(t,n,e){var o=e(0),r=e(2);function s(t,n){t=t||{},this.options=t,this.defaults=n.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(t.init),this.data=this.configureData(t.data),this.methods=this.configureMethods(t.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(t.transitions||[]),this.plugins=this.configurePlugins(t.plugins,n.plugin)}o(s.prototype,{addState:function(t){this.map[t]||(this.states.push(t),this.addStateLifecycleNames(t),this.map[t]={})},addStateLifecycleNames:function(t){this.lifecycle.onEnter[t]=r("on-enter-"+t),this.lifecycle.onLeave[t]=r("on-leave-"+t),this.lifecycle.on[t]=r("on-"+t)},addTransition:function(t){this.transitions.indexOf(t)<0&&(this.transitions.push(t),this.addTransitionLifecycleNames(t))},addTransitionLifecycleNames:function(t){this.lifecycle.onBefore[t]=r("on-before-"+t),this.lifecycle.onAfter[t]=r("on-after-"+t),this.lifecycle.on[t]=r("on-"+t)},mapTransition:function(t){var n=t.name,e=t.from,i=t.to;return this.addState(e),"function"!=typeof i&&this.addState(i),this.addTransition(n),this.map[e][n]=t,t},configureLifecycle:function(){return{onBefore:{transition:r("on-before-transition")},onAfter:{transition:r("on-after-transition")},onEnter:{state:r("on-enter-state")},onLeave:{state:r("on-leave-state")},on:{transition:r("on-transition")}}},configureInitTransition:function(t){return"string"==typeof t?this.mapTransition(o({},this.defaults.init,{to:t,active:!0})):"object"===(void 0===t?"undefined":i(t))?this.mapTransition(o({},this.defaults.init,t,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(t){return"function"==typeof t?t:"object"===(void 0===t?"undefined":i(t))?function(){return t}:function(){return{}}},configureMethods:function(t){return t||{}},configurePlugins:function(t,n){var e,i,o;for(e=0,i=(t=t||[]).length;e<i;e++)"function"==typeof(o=t[e])&&(t[e]=o=o()),o.configure&&o.configure(this);return t},configureTransitions:function(t){var n,e,i,o,r,s=this.defaults.wildcard;for(e=0;e<t.length;e++)for(i=t[e],o=Array.isArray(i.from)?i.from:[i.from||s],r=i.to||s,n=0;n<o.length;n++)this.mapTransition({name:i.name,from:o[n],to:r})},transitionFor:function(t,n){var e=this.defaults.wildcard;return this.map[t][n]||this.map[e][n]},transitionsFor:function(t){var n=this.defaults.wildcard;return Object.keys(this.map[t]).concat(Object.keys(this.map[n]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),t.exports=s},function(t,n,e){var i=e(0),o=e(5),r=e(1),s=[null,[]];function c(t,n){this.context=t,this.config=n,this.state=n.init.from,this.observers=[t]}i(c.prototype,{init:function(t){if(i(this.context,this.config.data.apply(this.context,t)),r.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(t){return Array.isArray(t)?t.indexOf(this.state)>=0:this.state===t},isPending:function(){return this.pending},can:function(t){return!this.isPending()&&!!this.seek(t)},cannot:function(t){return!this.can(t)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(t,n){var e=this.config.defaults.wildcard,i=this.config.transitionFor(this.state,t),o=i&&i.to;return"function"==typeof o?o.apply(this.context,n):o===e?this.state:o},fire:function(t,n){return this.transit(t,this.state,this.seek(t,n),n)},transit:function(t,n,e,i){var o=this.config.lifecycle,r=this.config.options.observeUnchangedState||n!==e;return e?this.isPending()?this.context.onPendingTransition(t,n,e):(this.config.addState(e),this.beginTransit(),i.unshift({transition:t,from:n,to:e,fsm:this.context}),this.observeEvents([this.observersForEvent(o.onBefore.transition),this.observersForEvent(o.onBefore[t]),r?this.observersForEvent(o.onLeave.state):s,r?this.observersForEvent(o.onLeave[n]):s,this.observersForEvent(o.on.transition),r?["doTransit",[this]]:s,r?this.observersForEvent(o.onEnter.state):s,r?this.observersForEvent(o.onEnter[e]):s,r?this.observersForEvent(o.on[e]):s,this.observersForEvent(o.onAfter.transition),this.observersForEvent(o.onAfter[t]),this.observersForEvent(o.on[t])],i)):this.context.onInvalidTransition(t,n,e)},beginTransit:function(){this.pending=!0},endTransit:function(t){return this.pending=!1,t},doTransit:function(t){this.state=t.to},observe:function(t){if(2===t.length){var n={};n[t[0]]=t[1],this.observers.push(n)}else this.observers.push(t[0])},observersForEvent:function(t){for(var n,e=0,i=this.observers.length,o=[];e<i;e++)(n=this.observers[e])[t]&&o.push(n);return[t,o,!0]},observeEvents:function(t,n,e){if(0===t.length)return this.endTransit(!0);var i=t[0][0],o=t[0][1],s=t[0][2];if(n[0].event=i,i&&s&&i!==e&&r.hook(this,"lifecycle",n),0===o.length)return t.shift(),this.observeEvents(t,n,i);var c=o.shift(),a=c[i].apply(c,n);return a&&"function"==typeof a.then?a.then(this.observeEvents.bind(this,t,n,i)).catch(this.endTransit.bind(this)):!1===a?this.endTransit(!1):this.observeEvents(t,n,i)},onInvalidTransition:function(t,n,e){throw new o("transition is invalid in current state",t,n,e,this.state)},onPendingTransition:function(t,n,e){throw new o("transition is invalid while previous transition is still in progress",t,n,e,this.state)}}),t.exports=c},function(t,n,e){t.exports=function(t,n,e,i,o){this.message=t,this.transition=n,this.from=e,this.to=i,this.current=o}},function(t,n,e){var o=e(0),r=e(2),s=e(1),c=e(3),a=e(4),h={is:function(t){return this._fsm.is(t)},can:function(t){return this._fsm.can(t)},cannot:function(t){return this._fsm.cannot(t)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(t,n,e){return this._fsm.onInvalidTransition(t,n,e)},onPendingTransition:function(t,n,e){return this._fsm.onPendingTransition(t,n,e)}},u={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(t){throw Error("use transitions to change state")}}};function d(t){return f(this||{},t)}function f(t,n){return l(t,new c(n,d)),t._fsm(),t}function l(t,n){if("object"!==(void 0===t?"undefined":i(t))||Array.isArray(t))throw Error("StateMachine can only be applied to objects");s.build(t,n),Object.defineProperties(t,u),o(t,h),o(t,n.methods),n.allTransitions().forEach(function(n){t[r(n)]=function(){return this._fsm.fire(n,[].slice.call(arguments))}}),t._fsm=function(){this._fsm=new a(this,n),this._fsm.init(arguments)}}d.version="3.0.0-rc.1",d.factory=function(){var t,n;"function"==typeof arguments[0]?(t=arguments[0],n=arguments[1]||{}):(t=function(){this._fsm.apply(this,arguments)},n=arguments[0]||{});var e=new c(n,d);return l(t.prototype,e),t.prototype._fsm.config=e,t},d.apply=f,d.defaults={wildcard:"*",init:{name:"init",from:"none"}},t.exports=d}])}),cc._RF.pop()},{}],storageManager:[function(t,n,e){"use strict";cc._RF.push(n,"10710Cz8ZRCqLlVtCy4fcaY","storageManager");var i=(cc.sys.localStorage.highestScore||(cc.sys.localStorage.highestScore=0),{getHighestScore:function(){return cc.sys.localStorage.highestScore},setHighestScore:function(t){cc.sys.localStorage.highestScore=t}});n.exports=i,cc._RF.pop()},{}]},{},["GotoWeb","NoticeText","backgroundLoader","btn","landMaker","perfectLabel","spriteCreator","state-machine","storageManager"]);