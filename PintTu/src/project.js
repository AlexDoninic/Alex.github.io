window.__require=function e(t,c,i){function n(s,a){if(!c[s]){if(!t[s]){var r=s.split("/");if(r=r[r.length-1],!t[r]){var l="function"==typeof __require&&__require;if(!a&&l)return l(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+s+"'")}}var g=c[s]={exports:{}};t[s][0].call(g.exports,function(e){return n(t[s][1][e]||e)},g,g.exports,e,t,c,i)}return c[s].exports}for(var o="function"==typeof __require&&__require,s=0;s<i.length;s++)n(i[s]);return n}({AdsMgr:[function(e,t,c){"use strict";cc._RF.push(t,"ec6a93PLMpGXptd97TIdnOS","AdsMgr"),cc.Cap={};var i=cc.Class({extends:cc.Component,properties:{},onGetSystemInfo:function(){return window.qg?qg.getSystemInfoSync():null},InitAds:function(){0!=cc.Mgr.OpenAds&&(cc.Cap.isShowBanner=!1,cc.Cap.isShowInsert=!1,cc.Cap.isShowNative=!1,this.canShowAds=!0,this.onGetSystemInfo()&&this.onGetSystemInfo().platformVersionCode<1031&&(cc.log("\u65e0\u6cd5\u663e\u793a\u5e7f\u544a"),this.canShowAds=!1))},showInsertAds:function(){if(0!=cc.Mgr.OpenAds&&0==cc.Cap.isShowInsert&&1==this.canShowAds){var e=qg.createInterstitialAd({posId:"3fe0e3c5b4f1497f97dc3234da735576"});e.onError(function(e){cc.Cap.isShowInsert=!1,cc.log("\u9999\u8549\u4e2a\u5df4\u62c9 interstitialAd\u5e7f\u544a\u6709\u95ee\u9898 "+JSON.stringify(e))}),e.onClose(function(){cc.Cap.isShowInsert=!1}),e.onLoad(function(){cc.Cap.showInsertAds=!0,e.show()})}},showBannerAds:function(){if(0!=cc.Mgr.OpenAds&&0==cc.Cap.isShowBanner&&1==this.canShowAds){var e=qg.createBannerAd({posId:"6c7a39bcc56145aeb62f76897cbf8a41",style:{left:0,top:0}});e.onError(function(e){cc.Cap.isShowBanner=!1,cc.log("\u9999\u8549\u4e2a\u5df4\u62c9 Banner\u5e7f\u544a\u6709\u95ee\u9898 "+JSON.stringify(e))}),e.onLoad(function(t){cc.Cap.isShowBanner=!0,e.show()}),e.onClose(function(){cc.Cap.isShowBanner=!1})}},showNativeAds:function(){if(0!=cc.Mgr.OpenAds&&0==cc.Cap.isShowNative&&1==this.canShowAds){var e=qg.createNativeAd({posId:"c114fbb51c6e4a7883805abd39ec4597"});e.onLoad(function(e){cc.Cap.isShowNative=!0,cc.log("\u9999\u8549\u4f60\u4e2a\u5df4\u62c9====\u539f\u751f\u5e7f\u544a\u8fd4\u56de\u6570\u636e"),console.log("jswrapper",JSON.stringify(e))}),e.offLoad(function(e){console.log("jswrapper",JSON.stringify(e)),cc.Cap.isShowNative=!1})}}});t.exports=i,cc._RF.pop()},{}],AppStart:[function(e,t,c){"use strict";cc._RF.push(t,"cb039cAazpMW4XtLu3JBNtD","AppStart"),cc.director.initMgr=!1,cc.Class({extends:cc.Component,properties:{LoadingNode:cc.Node,LoadingSp:cc.Node,startBtn:cc.Node,adsLbl:cc.Label,camera:cc.Camera},onLoad:function(){cc.sys.localStorage.clear(),this.startBtn.active=!1,0==cc.director.initMgr&&(function(){cc.Mgr={},cc.Mgr.OpenAds=!1,cc.Mgr.Parse=!1,cc.Mgr.preLoadingScene=!1,cc.director.getCollisionManager().enabled=!0;var t=e("AudioMgr");cc.Mgr.AudioMgr=new t,cc.Mgr.AudioMgr.init();var c=e("AdsMgr");cc.Mgr.AdsMgr=new c,cc.Mgr.AdsMgr.InitAds(),cc.Mgr.global=e("Global"),cc.Mgr.UserMgr=e("UserMgr");var i=e("MapDecoder");cc.Mgr.MapDecoder=new i,cc.Mgr.MapDecoder.MapDecodejson(function(e){e&&(cc.Mgr.Parse=!0)})}(),cc.director.initMgr=!0),cc.Mgr.AudioMgr.playBGM("bgm")},start:function(){this.camera.active=!1,cc.Mgr.AdsMgr.showBannerAds(),cc.director.preloadScene("gamescene",function(){cc.Mgr.preLoadingScene=!0}),this.LoadingSp.runAction(cc.repeatForever(cc.rotateBy(.2,45)))},onLoadSuccess:function(){},onShareGame:function(){cc.Mgr.AudioMgr.playSFX("dong"),"undefined"!=typeof FBInstant&&FBInstant.shareAsync({intent:"SHARE",image:this.getImgBase64(),text:"Play this Game",data:{myReplayData:"..."}}).then(function(){})},ShareFB:function(){console.log("facebook doFlaunt");var e=this.getImgBase64();FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"],minSize:3}).then(function(){FBInstant.updateAsync({action:"CUSTOM",cta:"Join The Fight",image:e,text:{default:"Let us play game together",localizations:{en_US:"Let us play game together",zh_CN:"\u6765\u73a9\u6e38\u620f\u5427\u4f19\u8ba1\uff01"}},template:"VILLAGE_INVASION",data:{myReplayData:"..."},strategy:"IMMEDIATE",notification:"NO_PUSH"}).then(function(){console.log("Message was sent successfully")})})},ShareTo:function(){if(cc.Mgr.AudioMgr.playSFX("dong"),"undefined"!=typeof FBInstant){var e=this;cc.loader.loadRes("/share.png",function(t,c){FBInstant.shareAsync({intent:"SHARE",image:e.ImgBase64(c),text:"\u4e00\u8d77\u62fc\u5566",data:{myReplayData:"..."}}).then(function(){console.log("\u5206\u4eab\u6210\u529f")})})}},ImgBase64:function(e){cc.find("Canvas");var t=document.createElement("canvas"),c=t.getContext("2d");t.width=720,t.height=376;var i=e.getHtmlElementObj();return c.drawImage(i,0,0),t.toDataURL("image/png")},getImgBase64:function(){var e=cc.view.getVisibleSize(),t=e.width,c=e.height;this.camera.active=!0;var i=new cc.RenderTexture,n=cc.game._renderContext;i.initWithSize(cc.visibleRect.width,cc.visibleRect.height,n.STENCIL_INDEX8),this.camera.targetTexture=i;var o=document.createElement("canvas"),s=o.getContext("2d");if(o.width=t,o.height=c,this.camera.render(),cc.renderType===cc.game.RENDERTYPE_CANVAS){var a=i.getSprite().getTexture().getHtmlElementObj();s.drawImage(a,0,0)}else if(cc.renderType===cc.game.RENDERTYPE_WEBGL){var r=new Uint8Array(t*c*4);i.readPixels(r);for(var l=4*t,g=0;g<c;g++){var h=c-1-g,u=new Uint8ClampedArray(r.buffer,h*t*4,l),p=new ImageData(u,t,1);s.putImageData(p,0,g)}}return this.camera.active=!1,o.toDataURL("image/png")},goToLevel:function(){cc.Mgr.AudioMgr.playSFX("dong"),cc.Mgr.UserMgr.getCurFinishLv()<cc.Mgr.MapDecoder.getMapLevelLenght()?(cc.Mgr.global.ChooseLv=Number(cc.Mgr.UserMgr.getCurFinishLv())+1,cc.director.loadScene("gamescene")):(cc.Mgr.global.ChooseLv=0,cc.director.loadScene("gamescene"))},update:function(e){1==cc.Mgr.Parse&&1==cc.Mgr.preLoadingScene&&(this.LoadingNode.active=!1,this.startBtn.active=!0)}}),cc._RF.pop()},{AdsMgr:"AdsMgr",AudioMgr:"AudioMgr",Global:"Global",MapDecoder:"MapDecoder",UserMgr:"UserMgr"}],AudioMgr:[function(e,t,c){"use strict";cc._RF.push(t,"03fbffJyD9Eu5t62plKaVt3","AudioMgr");var i=cc.Class({extends:cc.Component,properties:{bgmVolume:1,sfxVolume:.5,bgmAudioID:-1,sfxAudioID:-1,musicState:1,voiceState:1},init:function(){var e;cc.Mgr.loadSound=!1,null!=(e=cc.sys.localStorage.getItem("bgmVolume"))&&(this.bgmVolume=parseFloat(e)),null!=(e=cc.sys.localStorage.getItem("sfxVolume"))&&(this.sfxVolume=parseFloat(e)),cc.game.on(cc.game.EVENT_HIDE,function(){console.log("cc.audioEngine.pauseAll"),cc.audioEngine.pauseAll()}),cc.game.on(cc.game.EVENT_SHOW,function(){console.log("cc.audioEngine.resumeAll"),cc.audioEngine.resumeAll()})},getUrl:function(e){return cc.url.raw("resources/sound/"+e+".mp3")},playBGM:function(e){var t=this.getUrl(e);this.bgmAudioID>=0&&cc.audioEngine.stop(this.bgmAudioID),this.bgmAudioID=cc.audioEngine.play(t,!0,this.bgmVolume)},playSFX:function(e){var t=this.getUrl(e);cc.audioEngine.play(t,!1,this.sfxVolume)},setSFXVolume:function(e){this.sfxVolume!=e&&(cc.sys.localStorage.setItem("sfxVolume",e),this.sfxVolume=e)},setBGMVolume:function(e,t){this.bgmAudioID>=0&&(e>0?cc.audioEngine.resume(this.bgmAudioID):cc.audioEngine.pause(this.bgmAudioID)),(this.bgmVolume!=e||t)&&(cc.sys.localStorage.setItem("bgmVolume",e),this.bgmVolume=e,cc.audioEngine.setVolume(this.bgmAudioID,e))},pauseAll:function(){this.musicState=0,this.voiceState=0,this.bgmVolume=0,this.sfxVolume=0,cc.audioEngine.pauseAll()},resumeAll:function(){this.musicState=1,this.voiceState=1,this.bgmVolume=1,this.sfxVolume=.5,cc.audioEngine.resumeAll()},pauseMusic:function(){this.musicState=0,this.bgmVolume=0,this.bgmAudioID>=0&&cc.audioEngine.pause(this.bgmAudioID)},resumeMusic:function(){this.musicState=1,this.bgmVolume=.5,this.bgmAudioID>=0&&cc.audioEngine.resume(this.bgmAudioID)},pauseVoice:function(){this.voiceState=0,this.sfxVolume=0},resumeVoice:function(){this.voiceState=1,this.sfxVolume=.8},getMusicState:function(){return this.musicState},getVoiceState:function(){return this.voiceState}});t.exports=i,cc._RF.pop()},{}],BgChange:[function(e,t,c){"use strict";cc._RF.push(t,"5fa43OuGEdLxaSbsez12ccq","BgChange");var i=cc.Class({extends:cc.Component,properties:{bgFrameArr:[cc.SpriteFrame],bgSp:cc.Sprite},ChangeBg:function(){cc.Mgr.global.curPlayLvCount+=1;var e=cc.Mgr.global.BgCount;cc.Mgr.global.curPlayLvCount>=10&&(cc.Mgr.global.curPlayLvCount=0,cc.Mgr.global.BgCount+=1,cc.Mgr.global.BgCount>=3&&(cc.Mgr.global.BgCount=0),e=cc.Mgr.global.BgCount),this.bgSp.spriteFrame=this.bgFrameArr[e]}});t.exports=i,cc._RF.pop()},{}],GameScene:[function(e,t,c){"use strict";cc._RF.push(t,"752c0JZ6lNJH4UPFYglzueC","GameScene");var i=e("GameState"),n=(e("tile"),e("BgChange"));cc.Class({extends:cc.Component,properties:{UIAtlas:cc.SpriteAtlas,bgChange:n,tilePrefab:[cc.Prefab],tileGuidePrefab:cc.Prefab,tileParent:cc.Node,level:1,tileSize:80,tipTileSize:70,curLvlLbl:cc.Label,MenuNode:cc.Node,BottomCtrlNode:cc.Node,MenuTopNode:cc.Node,SucPanel:cc.Node,FinishLv:!1,toNextLv:!1,ShowMaskIng:!1,VoiceSp:cc.Sprite,ForeLvSP:cc.Sprite,BackLvSp:cc.Sprite,GuideLbl:cc.Label,MaskNode:cc.Node,MaskLvLbl:cc.Label,TipPanel:cc.Node,tipTileParent:cc.Node,tipTilePrefab:cc.Prefab,LvOnSpFrame:cc.SpriteFrame,LvOffSpFrame:cc.SpriteFrame},onLoad:function(){cc.Mgr.AdsMgr.showBannerAds(),cc.game.on(cc.game.EVENT_SHOW,function(){1==cc.Mgr.AudioMgr.getVoiceState()?cc.Mgr.AudioMgr.resumeAll():cc.Mgr.AudioMgr.pauseAll()});var e=cc.view.getVisibleSize();Math.floor(e.height/e.width*100)/100==1.77?cc.log("16/9========================================="):(this.BottomCtrlNode.setPosition(cc.v2(0,-100)),this.MenuTopNode.setPosition(cc.v2(0,-45))),this.BottomCtrlNode.active=!1,this.MenuNode.active=!1,this.SucPanel.active=!1,this.TipPanel.active=!1,this.RegisterEvent()},RegisterEvent:function(){cc.director.GlobalEvent.on("CheckAllTileDir",function(){this.checkAllTileDir()&&(cc.Mgr.AudioMgr.playSFX("di"),this.scheduleOnce(function(){cc.Mgr.AudioMgr.playSFX("win")},.5),0!=this.level&&1!=this.level||(0==this.level?this.GuideLbl.string=cc.director.NoticeText.Guide2:this.GuideLbl.string=cc.director.NoticeText.Guide4),cc.Mgr.global.gameState=i.FinishLv,this.level>=Number(cc.Mgr.UserMgr.getCurFinishLv())&&cc.Mgr.UserMgr.setCurFinishLv(this.level),this.FinishLv=!0,cc.log("\u987a\u5229\u5b8c\u6210"),cc.Mgr.AdsMgr.showInsertAds(),cc.Mgr.AdsMgr.showBannerAds(),this.TintAllTilesColor())},this),cc.director.GlobalEvent.on("ShowSucess",function(){this.ShowSucessPanel()},this)},ShowSucessPanel:function(){this.SucPanel.active=!0,this.SucPanel.runAction(cc.fadeIn(.5))},ShowMask:function(){this.ShowMaskIng=!1;var e=cc.sequence(cc.callFunc(function(){this.ShowMaskIng=!0,this.BottomCtrlNode.active=!1},this),cc.fadeIn(.4),cc.fadeOut(.4),cc.callFunc(function(){this.BottomCtrlNode.active=!0,this.ShowMaskIng=!1},this));0==this.ShowMaskIng&&this.MaskNode.runAction(e)},start:function(){this.bgChange.ChangeBg(),1==cc.Mgr.AudioMgr.getVoiceState()?this.VoiceSp.spriteFrame=this.UIAtlas.getSpriteFrame("voice_open"):this.VoiceSp.spriteFrame=this.UIAtlas.getSpriteFrame("voice_close"),this.GuideLbl.string="",this.toNextLv=!1,cc.log("\u9009\u62e9\u7684\u52a0\u8f7d\u5173\u5361(\u4ece0\u5f00\u59cb\u7b97\u8d77) = "+cc.Mgr.global.ChooseLv),this.level=cc.Mgr.global.ChooseLv,this.ShowMask(),this.MaskLvLbl.string="* "+(this.level+1).toString()+" *",this.curLvlLbl.string="* "+(this.level+1).toString()+" *";var e=cc.Mgr.MapDecoder.getMapLevelData(this.level),t=e.width*this.tileSize;cc.log("\u5bbd\u5ea6  "+e.width),this.tileParent.width=t,this.RefreshMainMap(e.width,e.tiles),this.tipTileParent.width=e.width*this.tipTileSize,this.RefreshTipMap(e.width,e.tiles),0==this.level?this.BackLvSp.spriteFrame=this.LvOffSpFrame:this.BackLvSp.spriteFrame=this.LvOnSpFrame,this.level>cc.Mgr.UserMgr.getCurFinishLv()?this.ForeLvSP.spriteFrame=this.LvOffSpFrame:this.ForeLvSP.spriteFrame=this.LvOnSpFrame},RefreshMainMap:function(e,t){cc.Mgr.global.hasEmitSucess=!1,cc.Mgr.global.gameState=i.Game;for(var c=0;c<t.length;c++){var n=t[c],o=null;0!=this.level||0!=c&&5!=c?0==this.level&&0!=c&&5!=c?(o=cc.instantiate(this.tilePrefab[n.spType])).getComponent("tile").initGuide(n.spType,n.toDir):1==this.level?(o=cc.instantiate(this.tilePrefab[n.spType]),2==c||3==c?o.getComponent("tile").initGuide(n.spType,1):4==c||5==c?o.getComponent("tile").initGuide(n.spType,3):6==c||7==c?o.getComponent("tile").initGuide(n.spType,2):o.getComponent("tile").initGuide(n.spType,0)):(o=cc.instantiate(this.tilePrefab[n.spType])).getComponent("tile").init(n.spType):(o=cc.instantiate(this.tileGuidePrefab),0==c?o.getComponent("GuideTile").init(n.spType,3):o.getComponent("GuideTile").init(n.spType,1)),0!=this.level&&1!=this.level||(0==this.level?this.GuideLbl.string=cc.director.NoticeText.Guide1:this.GuideLbl.string=cc.director.NoticeText.Guide3),o.active=!0,o.parent=this.tileParent}},RefreshTipMap:function(e,t){for(var c=0;c<t.length;c++){var i=t[c],n=cc.instantiate(this.tipTilePrefab),o=n.getComponent("TipTile");if(null!=o){o.initTipTile(i.spType,i.toDir);var s=new cc.Color(135,125,69);o.SetColor(s)}n.active=!0,n.parent=this.tipTileParent}},ClearTipMap:function(){for(var e=this.tipTileParent.children,t=0;t<e.length;t++)e[t].destroy()},ClearMainMap:function(){for(var e=this.tileParent.children,t=0;t<e.length;t++)e[t].destroy()},TintAllTilesColor:function(){cc.Mgr.global.gameState==i.FinishLv&&cc.director.GlobalEvent.emit("TweenTileColor",{})},FadeOutAndDestoyAllTiles:function(){if(cc.Mgr.global.gameState==i.FinishLv)for(var e=this.tileParent.children,t=0;t<e.length;t++){e[t];e[t].runAction(cc.fadeOut(1))}},checkAllTileDir:function(){for(var e=this.tileParent.children,t=0;t<e.length;t++){var c=e[t].getComponent("tile");if(null!=c){if(1!=c.CheckDir())return!1}else if(null!=(c=e[t].getComponent("GuideTile"))&&1!=c.CheckDir())return!1}return!0},BackLastLevel:function(){cc.Mgr.AdsMgr.showBannerAds(),0!=this.level&&1!=this.toNextLv&&1!=this.OpenIng&&1!=this.CloseIng&&(1==this.MenuNode.active&&this.CloseMenu(),cc.director.GlobalEvent.clear(),cc.Mgr.global.ChooseLv=this.level-1,cc.Mgr.global.ChooseLv>=0&&(this.RefreshGameLevelData(),this.RegisterEvent()))},CloseSucessPanel:function(){var e=cc.sequence(cc.fadeOut(.1),cc.callFunc(function(){this.SucPanel.active=!1},this));this.SucPanel.runAction(e)},RefreshGameLevelData:function(){this.bgChange.ChangeBg(),this.BottomCtrlNode.active=!1,this.MenuNode.active=!1,this.CloseSucessPanel(),this.TipPanel.active=!1,cc.log("\u9009\u62e9\u7684\u52a0\u8f7d\u5173\u5361(\u4ece0\u5f00\u59cb\u7b97\u8d77) = "+cc.Mgr.global.ChooseLv),this.level=cc.Mgr.global.ChooseLv,this.GuideLbl.string="",this.toNextLv=!1,this.MaskLvLbl.string="* "+(this.level+1).toString()+" *",this.curLvlLbl.string="* "+(this.level+1).toString()+" *",this.ShowMask(),0==this.level?this.BackLvSp.spriteFrame=this.LvOffSpFrame:this.BackLvSp.spriteFrame=this.LvOnSpFrame,this.level>cc.Mgr.UserMgr.getCurFinishLv()?this.ForeLvSP.spriteFrame=this.LvOffSpFrame:this.ForeLvSP.spriteFrame=this.LvOnSpFrame;var e=cc.Mgr.MapDecoder.getMapLevelData(this.level),t=cc.sequence(cc.callFunc(function(){this.toNextLv=!0},this),cc.fadeOut(.5),cc.callFunc(function(){this.ClearMainMap(),this.ClearTipMap()},this),cc.fadeIn(.5),cc.callFunc(function(){this.tileParent.width=e.width*this.tileSize,this.RefreshMainMap(e.width,e.tiles),this.tipTileParent.width=e.width*this.tipTileSize,this.RefreshTipMap(e.width,e.tiles),this.toNextLv=!1},this));0==this.toNextLv&&this.tileParent.runAction(t)},ToNextLevel:function(){cc.Mgr.AdsMgr.showBannerAds(),cc.Mgr.global.gameState!=i.FinishLv&&this.level>Number(cc.Mgr.UserMgr.getCurFinishLv())||1!=this.toNextLv&&1!=this.OpenIng&&1!=this.CloseIng&&(1==this.MenuNode.active&&this.CloseMenu(),cc.Mgr.global.ChooseLv=this.level+1,cc.director.GlobalEvent.clear(),cc.Mgr.global.ChooseLv<cc.Mgr.MapDecoder.getMapLevelLenght()&&(this.RefreshGameLevelData(),this.RegisterEvent()))},OpenMenu:function(){this.OpenIng=!1;var e=cc.sequence(cc.callFunc(function(){cc.Mgr.global.gameState=i.Menu,this.OpenIng=!0},this),cc.scaleBy(.05,.8),cc.callFunc(function(){this.MenuNode.active=!0,this.BottomCtrlNode.active=!1,this.OpenIng=!1},this));0==this.OpenIng&&0==this.ShowMaskIng&&(cc.Mgr.AudioMgr.playSFX("dong"),this.tileParent.runAction(e))},RefreshGame:function(){cc.log("\u91cd\u7f6e\u65b9\u5411"),cc.Mgr.global.gameState=i.Menu;for(var e=this.tileParent.children,t=0;t<e.length;t++)e[t].setRotation(0)},VoiceOpenClose:function(){1==cc.Mgr.AudioMgr.getVoiceState()?(this.VoiceSp.spriteFrame=this.UIAtlas.getSpriteFrame("voice_close"),cc.Mgr.AudioMgr.pauseAll()):(this.VoiceSp.spriteFrame=this.UIAtlas.getSpriteFrame("voice_open"),cc.Mgr.AudioMgr.resumeAll())},CloseMenu:function(){this.CloseIng=!1;var e=cc.sequence(cc.callFunc(function(){this.CloseIng=!0,cc.Mgr.global.gameState=i.Game},this),cc.scaleBy(.05,1.25),cc.callFunc(function(){this.MenuNode.active=!1,this.BottomCtrlNode.active=!0,this.CloseIng=!1},this));0==this.CloseIng&&(cc.Mgr.AudioMgr.playSFX("dong"),this.tileParent.runAction(e))},OpenTipPanel:function(){cc.Mgr.AdsMgr.showNativeAds(),cc.Mgr.AudioMgr.playSFX("dong"),cc.Mgr.global.gameState=i.Menu,this.TipPanel.active=!0,this.BottomCtrlNode.active=!1},CloseTipPanel:function(){cc.Mgr.global.gameState=i.Game,this.TipPanel.active=!1,this.BottomCtrlNode.active=!0}}),cc._RF.pop()},{BgChange:"BgChange",GameState:"GameState",tile:"tile"}],GameState:[function(e,t,c){"use strict";cc._RF.push(t,"10a95T6qK5GarMaiRvPHono","GameState");var i=cc.Enum({Menu:0,Game:1,FinishLv:2});t.exports=i,cc._RF.pop()},{}],GlobalEvent:[function(e,t,c){"use strict";cc._RF.push(t,"ee7d234LKZEM6QklASaLrg0","GlobalEvent"),cc.director.GlobalEvent={handles_:{},emit:function(e,t){var c=[];for(var i in console.log("\u4e8b\u4ef6\u5206\u53d1",e),t.eventName=e,this.handles_)if(i==e)for(var n=0;n<this.handles_[i].length;n++)if(this.handles_[i][n]){var o=this.handles_[i][n](t);c.push(o)}return c},on:function(e,t,c){console.log("\u6536\u5230\u4e8b\u4ef6",e),this.handles_[e]=this.handles_[e]||[],this.handles_[e].push(t.bind(c))},off:function(e){if(this.handles_[e])for(var t=0;t<this.handles_[e].length;t++)this.handles_[e][t]=null},clear:function(){for(var e in this.handles_)for(var t=0;t<this.handles_[e].length;t++)this.handles_[e][t]=null}},cc._RF.pop()},{}],Global:[function(e,t,c){"use strict";cc._RF.push(t,"ba6d3SsbQVMub9ZaMnXZ62h","Global");var i=e("GameState"),n=cc.Class({extends:cc.Component,statics:{AllLevelCount:cc.Integer,ChooseLv:cc.Integer,gameState:i.Menu,BgCount:0,curPlayLvCount:0,hasEmitSucess:!1},ResetEmitSucessState:function(){this.hasEmitSucess=!1}});t.exports=n,cc._RF.pop()},{GameState:"GameState"}],GuideTile:[function(e,t,c){"use strict";cc._RF.push(t,"98f95fRfxdC95gIh3UBuYoG","GuideTile");var i=e("tile"),n=cc.Class({extends:cc.Component,properties:{Tile:i},start:function(){},init:function(e,t){this.Tile.initGuide(e,t)},CheckDir:function(){return this.Tile.CheckDir()}});t.exports=n,cc._RF.pop()},{tile:"tile"}],HallScene:[function(e,t,c){"use strict";cc._RF.push(t,"9f1b28tJq5M8b6PjPaLNYeB","HallScene");var i=e("GameState");cc.Class({extends:cc.Component,properties:{lvItemPrefab:cc.Prefab,lvItemParent:cc.Node},onLoad:function(){cc.Mgr.global.gameState=i.Menu,this.LoadLevelData()},start:function(){},LoadLevelData:function(){var e=cc.Mgr.MapDecoder.getMapLevelLenght(),t=cc.Mgr.UserMgr.getCurFinishLv();cc.log("\u62ff\u5230level\u6570\u91cf = "+e);for(var c=0;c<e;c++){var i=cc.instantiate(this.lvItemPrefab);c<=t&&(i.color=new cc.color(150,150,150)),i.getComponent("levelItem").init(c),i.active=!0,i.parent=this.lvItemParent}},OpenUrl:function(){cc.sys.openURL("https://alexdoninic.github.io/MyLove/")},goToLevel:function(){cc.Mgr.UserMgr.getCurFinishLv()<cc.Mgr.MapDecoder.getMapLevelLenght()?(cc.Mgr.global.ChooseLv=Number(cc.Mgr.UserMgr.getCurFinishLv())+1,cc.director.loadScene("gamescene")):(cc.Mgr.global.ChooseLv=1,cc.director.loadScene("gamescene"))}}),cc._RF.pop()},{GameState:"GameState"}],LoadingScene:[function(e,t,c){"use strict";cc._RF.push(t,"8320fDOjPdMoJogQVro7f3x","LoadingScene"),cc.Class({extends:cc.Component,properties:{tipLabel:cc.Label},onLoad:function(){},start:function(){var e=this,t="\u4f60\u7684\u9152\u7a9d\u6ca1\u6709\u9152,\u53ef\u6211\u9189\u5f97\u50cf\u4e2a\u50bb\u5b50",c=0;this.tipLabel.string="",this.schedule(function(){++c==t.length+1?e.onLoadSuccess():e.tipLabel.string=t.substring(0,c)},.3,t.length+1,.3)},onLoadSuccess:function(){cc.director.loadScene("HallScene")}}),cc._RF.pop()},{}],MapDecoder:[function(e,t,c){"use strict";cc._RF.push(t,"e579d1pO5VJQ5Lj5MvPZM+6","MapDecoder");var i=e("TileData"),n=e("levelData"),o=cc.Class({extends:cc.Component,properties:{jsonName:"levels",levelDataList:{default:[],type:[n]}},MapDecodejson:function(e){cc.log("MLGB \u5f00\u59cb\u89e3\u6790\u6570\u636e\u4e86");var t=this;t.parseReCb=e,cc.loader.loadRes("json/"+t.jsonName,function(e,c){if(e)return cc.log("\u9519\u8bef\u4fe1\u606f = "+e),void t.parseReCb(!1);var o=c.json.levels;cc.log("\u957f\u5ea6 = "+o.length),cc.Mgr.global.AllLevelCount=o.length;for(var s=0;s<o.length;s++){var a=new n;a.Id=s.toString(),a.width=o[s].width,a.height=o[s].height;for(var r=0;r<o[s].tiles.length;r++){var l=new i,g=o[s].tiles[r];l.spType=g[0],l.toDir=g[1],a.tiles[r]=l}t.levelDataList[s]=a}t.parseReCb(!0)})},getMapLevelLenght:function(){return this.levelDataList.length},getMapLevelData:function(e){return this.levelDataList[e]}});t.exports=o,cc._RF.pop()},{TileData:"TileData",levelData:"levelData"}],NoticeText:[function(e,t,c){"use strict";cc._RF.push(t,"516dcSPJD1MzJM23TZFk0Rw","NoticeText"),cc.director.NoticeText={Guide1:"\u70b9\u51fb\u65cb\u8f6c\u6a21\u5757\uff0c\u5c06\u6563\u4e71\u7684\u7ebf\u6761\u5b8c\u6574\u8fde\u63a5",Guide2:"\u5b8c\u6210\u76ee\u6807\uff0c\u5e72\u7684\u6f02\u4eae\uff01",Guide3:"\u63d0\u793a\uff1a\u62c6\u5f00\u5706\u5f62\uff0c\u4e0e\u5de6\u53f3\u7684\u7ebf\u6761\u5b8c\u6574\u8fde\u63a5",Guide4:"\u592a\u5389\u5bb3\u4e86\u3002\u66f4\u6709\u8da3\u7684\u6311\u6218\u7b49\u5f85\u7740\u4f60"},cc._RF.pop()},{}],TileData:[function(e,t,c){"use strict";cc._RF.push(t,"973abbGgT5GGbF+vyoO26Kw","TileData");var i=cc.Class({name:"TileData",properties:{spType:cc.Integer,toDir:cc.Integer}});t.exports=i,cc._RF.pop()},{}],TipTile:[function(e,t,c){"use strict";cc._RF.push(t,"735bc4wuXBPWKJ+FovAsYl3","TipTile");var i=cc.Class({extends:cc.Component,properties:{SpFrameArr:[cc.SpriteFrame],Sp:cc.Sprite},start:function(){},initTipTile:function(e,t){this.Sp.spriteFrame=this.SpFrameArr[e],this.node.setRotation(90*t)},SetColor:function(e){this.Sp.node.color=e}});t.exports=i,cc._RF.pop()},{}],TweenColor:[function(e,t,c){"use strict";cc._RF.push(t,"be084rW0AxBuYV0rlbu82gU","TweenColor");var i=cc.Class({extends:cc.Component,statics:{}});t.exports=i,cc._RF.pop()},{}],UserMgr:[function(e,t,c){"use strict";cc._RF.push(t,"6c7cabKaWJGWIUD94DDyEW6","UserMgr");var i=cc.Class({extends:cc.Component,statics:{getCurFinishLv:function(){var e=cc.sys.localStorage.getItem("FinishLv");return null==e&&(e=-1),e},setCurFinishLv:function(e){var t=cc.sys.localStorage.getItem("FinishLv");null==t&&(t=-1),cc.log("\u66f4\u65b0\u5b58\u50a8\u5173\u5361\u6570\u636e = "+e),e>t&&cc.sys.localStorage.setItem("FinishLv",e)}}});t.exports=i,cc._RF.pop()},{}],enterBox:[function(e,t,c){"use strict";cc._RF.push(t,"f00bdsI/0xPYohfbdqbu1oa","enterBox");cc.Class({extends:cc.Component,properties:{isContacting:!1},start:function(){},onCollisionEnter:function(e,t){1!=this.isContacting&&(this.isContacting=!0)},onCollisionStay:function(e,t){1!=this.isContacting&&(this.isContacting=!0)},onCollisionExit:function(e,t){this.isContacting=!1},IsContacting:function(){return this.isContacting}});cc._RF.pop()},{}],levelData:[function(e,t,c){"use strict";cc._RF.push(t,"00e90YGLytAMLnd+d8HHVv9","levelData");var i=e("TileData"),n=cc.Class({name:"levelData",properties:{Id:"",width:cc.Integer,height:cc.Integer,tiles:[i]}});t.exports=n,cc._RF.pop()},{TileData:"TileData"}],levelItem:[function(e,t,c){"use strict";cc._RF.push(t,"b9e61zkSPFIGboyvDVM8bcp","levelItem");var i=cc.Class({extends:cc.Component,properties:{lvLbl:cc.Label,level:cc.Integer},start:function(){},init:function(e){this.level=e,this.lvLbl.string="Level-"+(e+1).toString()},GotoLevelScene:function(){cc.Mgr.global.ChooseLv=this.level,cc.director.loadScene("gamescene")}});t.exports=i,cc._RF.pop()},{}],tile:[function(e,t,c){"use strict";cc._RF.push(t,"955a1GcfL5EKoQ1b11TtgVy","tile");var i=e("GameState"),n=e("enterBox"),o=cc.Class({extends:cc.Component,properties:{rotationState:!1,enterBoxArr:[n],SpNode:cc.Sprite,FinishSpFrame:cc.SpriteFrame,CurDir:0,spType:1},onLoad:function(){this.CurDir=0;this.node.on("touchstart",function(e){if(cc.Mgr.global.gameState==i.Game){var t=cc.sequence(cc.callFunc(function(){this.rotationState=!0},this),cc.rotateBy(.1,90),cc.callFunc(function(){cc.director.GlobalEvent.emit("CheckAllTileDir",{}),this.rotationState=!1},this));0==this.rotationState&&(cc.Mgr.AudioMgr.playSFX("dong"),this.node.runAction(t),this.CurDir+=1,this.CurDir>3&&(this.CurDir=0))}},this),cc.director.GlobalEvent.on("TweenTileColor",function(e){this.scheduleOnce(function(){this.TweenColor()},.25)},this)},init:function(e){this.spType=e},initGuide:function(e,t){this.spType=e,this.node.setRotation(90*t)},start:function(){},TweenColor:function(){this.SpNode.spriteFrame=this.FinishSpFrame;var e=cc.tintTo(1.5,61,193,171,255),t=cc.tintTo(1.5,157,86,514,255),c=cc.tintTo(1.5,229,145,41,255),i=cc.callFunc(function(){0==cc.Mgr.global.hasEmitSucess&&(cc.director.GlobalEvent.emit("ShowSucess",{}),cc.Mgr.global.hasEmitSucess=!0)},this);if(0==cc.Mgr.global.BgCount){var n=cc.sequence(e,i);this.SpNode.node.runAction(n)}else if(1==cc.Mgr.global.BgCount){n=cc.sequence(t,i);this.SpNode.node.runAction(n)}else{n=cc.sequence(c,i);this.SpNode.node.runAction(n)}},CheckDir:function(){for(var e=!0,t=0;t<this.enterBoxArr.length;t++)if(0==this.enterBoxArr[t].IsContacting()){e=!1;break}return e}});t.exports=o,cc._RF.pop()},{GameState:"GameState",enterBox:"enterBox"}]},{},["AdsMgr","AppStart","AudioMgr","BgChange","GameScene","GameState","Global","GlobalEvent","GuideTile","HallScene","LoadingScene","MapDecoder","NoticeText","TileData","TipTile","TweenColor","UserMgr","enterBox","levelData","levelItem","tile"]);