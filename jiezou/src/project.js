window.__require=function t(e,o,i){function s(n,c){if(!o[n]){if(!e[n]){var r=n.split("/");if(r=r[r.length-1],!e[r]){var h="function"==typeof __require&&__require;if(!c&&h)return h(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+n+"'")}}var l=o[n]={exports:{}};e[n][0].call(l.exports,function(t){return s(e[n][1][t]||t)},l,l.exports,t,e,o,i)}return o[n].exports}for(var a="function"==typeof __require&&__require,n=0;n<i.length;n++)s(i[n]);return s}({AppStart:[function(t,e,o){"use strict";cc._RF.push(e,"1857aBD2CxP8r6kveq+KWQN","AppStart");var i=t("UIMgr");cc.Class({extends:cc.Component,properties:{uiMgr:i},onLoad:function(){(function(){cc.Mgr={},cc.Mgr.InitAll=!1;var e=t("AudioMgr");cc.Mgr.AudioMgr=new e,cc.Mgr.AudioMgr.init();var o=t("DataMapMgr");cc.Mgr.DataMapMgr=new o,cc.Mgr.DataMapMgr.InitMaps();var i=t("UserData");cc.Mgr.UserData=new i,cc.Mgr.Global=t("Global"),cc.Mgr.Global.InitData(),cc.Mgr.ShareInfos=t("ShareInfos"),cc.Mgr.ShareInfos.init(),cc.Mgr.PlatformController=t("PlatformController"),cc.Mgr.PlatformController.Init()})();var e=this;cc.director.on("DecoderMapsEnd",function(t){cc.Mgr.Global.RefreshBonusData(),cc.Mgr.UserData.initData(),e.RefreshUI(),cc.Mgr.InitAll=!0})},RefreshUI:function(){this.uiMgr.RefreshUI()},start:function(){cc.Mgr.Global.InitRewardLifeTime(),cc.Mgr.PlatformController.ShareTopNav(),cc.Mgr.PlatformController.setUserCloudStorage(cc.Mgr.UserData.getHighScore()),cc.Mgr.AudioMgr.playBGM("Bg1")}}),cc._RF.pop()},{AudioMgr:"AudioMgr",DataMapMgr:"DataMapMgr",Global:"Global",PlatformController:"PlatformController",ShareInfos:"ShareInfos",UIMgr:"UIMgr",UserData:"UserData"}],AudioMgr:[function(t,e,o){"use strict";cc._RF.push(e,"fb34faItr9BNo7ofM1Dk7Xd","AudioMgr");var i=cc.Class({extends:cc.Component,properties:{bgmVolume:.5,sfxVolume:.8,bgmAudioID:-1,sfxAudioID:-1,musicState:1,voiceState:1},init:function(){var t;cc.Mgr.loadSound=!1,null!=(t=cc.sys.localStorage.getItem("bgmVolume"))&&(this.bgmVolume=parseFloat(t)),null!=(t=cc.sys.localStorage.getItem("sfxVolume"))&&(this.sfxVolume=parseFloat(t)),cc.game.on(cc.game.EVENT_HIDE,function(){console.log("cc.audioEngine.pauseAll"),cc.audioEngine.pauseAll()}),cc.game.on(cc.game.EVENT_SHOW,function(){console.log("cc.audioEngine.resumeAll"),cc.audioEngine.resumeAll()})},getUrl:function(t){return cc.url.raw("resources/sound/"+t+".mp3")},playBGM:function(t){var e=this.getUrl(t);this.bgmAudioID>=0&&cc.audioEngine.stop(this.bgmAudioID),this.bgmAudioID=cc.audioEngine.play(e,!0,this.bgmVolume)},playSFX:function(t){var e=this.getUrl(t);cc.audioEngine.play(e,!1,this.sfxVolume)},setSFXVolume:function(t){this.sfxVolume!=t&&(cc.sys.localStorage.setItem("sfxVolume",t),this.sfxVolume=t)},setBGMVolume:function(t,e){this.bgmAudioID>=0&&(t>0?cc.audioEngine.resume(this.bgmAudioID):cc.audioEngine.pause(this.bgmAudioID)),(this.bgmVolume!=t||e)&&(cc.sys.localStorage.setItem("bgmVolume",t),this.bgmVolume=t,cc.audioEngine.setVolume(this.bgmAudioID,t))},pauseAll:function(){this.musicState=0,this.voiceState=0,this.bgmVolume=0,this.sfxVolume=0,cc.audioEngine.pauseAll()},resumeAll:function(){this.musicState=1,this.voiceState=1,this.bgmVolume=.5,this.sfxVolume=.8,cc.audioEngine.resumeAll()},pauseMusic:function(){this.musicState=0,this.bgmVolume=0,this.bgmAudioID>=0&&cc.audioEngine.pause(this.bgmAudioID)},resumeMusic:function(){this.musicState=1,this.bgmVolume=.5,this.bgmAudioID>=0&&cc.audioEngine.resume(this.bgmAudioID)},pauseVoice:function(){this.voiceState=0,this.sfxVolume=0},resumeVoice:function(){this.voiceState=1,this.sfxVolume=.8},getMusicState:function(){return this.musicState},getVoiceState:function(){return this.voiceState}});e.exports=i,cc._RF.pop()},{}],BonusType:[function(t,e,o){"use strict";cc._RF.push(e,"dce32AyQ3VKZZwIkBNZ99k4","BonusType");var i=cc.Enum({CoinBonus:1,DiamondBonus:2});e.exports=i,cc._RF.pop()},{}],BoxType:[function(t,e,o){"use strict";cc._RF.push(e,"bc8b6hIS/lE0Jme8iyOdg5h","BoxType");var i=cc.Enum({Blank:0,Normal:1,Stone:2,Mine:10});e.exports=i,cc._RF.pop()},{}],Box:[function(t,e,o){"use strict";cc._RF.push(e,"1e540AdGGFIb7sRN89LEHE/","Box");var i=t("BoxType"),s=(t("DIR"),cc.Class({extends:cc.Component,properties:{Atlas:cc.SpriteAtlas,Sp:cc.Sprite,flagNum:1,boxType:{default:i.Blank,type:i},coinNode:cc.Node,exploreNode:cc.Node,boxAnima:cc.Animation,effectAnima:cc.Animation},InitBox:function(t,e,o){this.flagNum=o;var i="box_"+this.flagNum;this.Sp.spriteFrame=this.Atlas.getSpriteFrame(i),this.posX=t,this.posY=e,this.coinNode.active=!1,this.RefreshBoxType()},RefreshBoxInit:function(){this.flagNum=0;var t="box_"+this.flagNum;this.RefreshBoxType(),this.coinNode.active=!1,this.Sp.spriteFrame=this.Atlas.getSpriteFrame(t)},RefreshToBoxLastStep:function(t){this.flagNum=t.flagNum;var e="box_"+this.flagNum;this.RefreshBoxType(),this.coinNode.active=t.showCoin,this.Sp.spriteFrame=this.Atlas.getSpriteFrame(e)},RefreshBoxFlagNum:function(t){this.flagNum=t,this.RefreshBoxType();var e="box_"+this.flagNum;this.Sp.spriteFrame=this.Atlas.getSpriteFrame(e)},RefreshBox:function(t){this.flagNum=t.flagNum;var e="box_"+this.flagNum;this.RefreshBoxType(),1==this.coinNode.active&&(this.coinNode.active=!1,this.effectAnima.node.active=!0,this.effectAnima.play("coinEffect"),cc.Mgr.AudioMgr.playSFX("coin"),cc.director.emit("AddGameScore",{})),this.Sp.spriteFrame=this.Atlas.getSpriteFrame(e)},RefreshBoxType:function(){2==this.flagNum?this.boxType=i.Stone:1==this.flagNum?this.boxType=i.Normal:this.flagNum<=18&&this.flagNum>=10?this.boxType=i.Mine:0==this.flagNum&&(this.boxType=i.Blank)},PlayAnimation:function(t){this.boxAnima.play(t)},DisShow:function(){this.RefreshBoxInit(),cc.director.emit("SetPlayState",{}),this.coinNode.active=!0},UseBoomSkill:function(){cc.Mgr.Global.checkPos[0]!=this.posX||cc.Mgr.Global.checkPos[1]!=this.posY?1==cc.Mgr.Global.UseSkillState&&(this.exploreNode.active=!0,this.boxAnima.play("explore"),cc.director.emit("UseBoomSkillEnd",{})):cc.log("\u4f60\u600e\u4e48\u80fd\u70b9\u51fb\u73a9\u5bb6\u8282\u70b9\u5462")},EndExplore:function(){this.RefreshBoxInit(),this.coinNode.active=!1,this.exploreNode.active=!1},IsCoinNodeActive:function(){return 1==this.coinNode.active}}));e.exports=s,cc._RF.pop()},{BoxType:"BoxType",DIR:"DIR"}],CoinEffect:[function(t,e,o){"use strict";cc._RF.push(e,"ec112Fg+QFEj7xH+P5yfcN1","CoinEffect");var i=cc.Class({extends:cc.Component,properties:{EffectNode:cc.Node},EndCoinEffect:function(){this.EffectNode.active=!1}});e.exports=i,cc._RF.pop()},{}],DIR:[function(t,e,o){"use strict";cc._RF.push(e,"151a1l9fORPRKWDH7vY769o","DIR");var i=cc.Enum({LEFT:1,RIGHT:2,UP:3,DOWN:4});e.exports=i,cc._RF.pop()},{}],DataMapMgr:[function(t,e,o){"use strict";cc._RF.push(e,"ea360DSHMNHw79ZbQP7komE","DataMapMgr");var i=t("SkinMap"),s=t("DataType"),a=cc.Class({extends:cc.Component,properties:{skinMap:null},InitMaps:function(t){this.skinMap=new i;var e=this;this.decodeAll=0,this.skinMap.DecodeJson(function(t){t&&(e.decodeAll+=100,100==e.decodeAll&&cc.director.emit("DecoderMapsEnd",{}))})},getDataByDataTypeAndId:function(t,e){var o=null;switch(t){case s.Skin:o=this.skinMap.getDataById(e)}return o},getDataListLengthByDataType:function(t){var e=0;switch(t){case s.Skin:e=this.skinMap.getJsonLength()}return e},getDataListByDataType:function(t){var e=0;switch(t){case s.Skin:e=this.skinMap.getDataList()}return e}});e.exports=a,cc._RF.pop()},{DataType:"DataType",SkinMap:"SkinMap"}],DataType:[function(t,e,o){"use strict";cc._RF.push(e,"78fc2emXFlO7LF5tmlnAtzw","DataType");var i=cc.Enum({Skin:1});e.exports=i,cc._RF.pop()},{}],GameController:[function(t,e,o){"use strict";cc._RF.push(e,"1d84cMbAEBN570AMd9CemLg","GameController");t("Box");var i=t("DIR"),s=t("Global"),a=t("UIScore"),n=t("GameState"),c=t("BoxType"),r=cc.Class({extends:cc.Component,properties:{colsNum:5,rowsNum:5,parentNode:cc.Node,playerFlagNum:10,gameState:{default:n.Play,type:n},checkPos:{default:[],type:[cc.Integer]},uiScore:a,uiOverNode:cc.Node},onLoad:function(){var t=this.parentNode.children;this.boxMap=new Array(this.rowsNum);for(var e=0;e<this.rowsNum;e++){for(var o=new Array(this.colsNum),i=0;i<this.colsNum;i++){var s=e*this.colsNum+i;o[i]=t[s].getComponent("Box")}this.boxMap[e]=o}this.addListeners();var a=this;cc.director.on("SetPlayState",function(t){a.gameState=n.Play}),cc.director.on("UseSkin",function(t){a.RefreshCheckBoxFlagNum()})},RefreshCheckBoxFlagNum:function(){this.boxMap[this.checkPos[0]][this.checkPos[1]].RefreshBoxFlagNum(cc.Mgr.UserData.getCurSkinId()),cc.Mgr.UserData.RefreshBoxMapRem(this.checkPos[0],this.checkPos[1],cc.Mgr.UserData.getCurSkinId(),!1)},SaveReBoxMapData:function(){for(var t=0;t<this.rowsNum;t++)for(var e=0;e<this.colsNum;e++){var o=this.boxMap[t][e].flagNum,i=this.boxMap[t][e].IsCoinNodeActive();cc.Mgr.UserData.RefreshBoxMapRem(t,e,o,i)}},ReturnOneStep:function(){for(var t=0;t<this.rowsNum;t++)for(var e=0;e<this.colsNum;e++){var o=cc.Mgr.UserData.GetReBoxParam(t,e);if(this.boxMap[t][e].RefreshToBoxLastStep(o),this.boxMap[t][e].boxType==c.Mine){var i={};i.x=t,i.y=e,this.refreshCheckPos(i)}}},StartGame:function(){this.playerFlagNum=cc.Mgr.UserData.getCurSkinId(),cc.Mgr.AudioMgr.playBGM("Bg2"),cc.Mgr.UserData.IsTutorialOver()?this.RefreshLayOut():this.RefreshLayOutForTutorial()},ReStartGame:function(){this.playerFlagNum=cc.Mgr.UserData.getCurSkinId(),this.RefreshLayOut()},OffTouchEventListener:function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onTouched,this)},AddTouchEventListener:function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouched,this)},addListeners:function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouched,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKey,this)},ClearBoard:function(){for(var t=this.rowsNum-1;t>=0;t--)for(var e=0;e<this.colsNum;e++)this.boxMap[t][e].RefreshBoxInit()},checkGameOver:function(){var t=this.checkCanMove(i.LEFT),e=this.checkCanMove(i.RIGHT),o=this.checkCanMove(i.UP),s=this.checkCanMove(i.DOWN);0==t.canMove&&0==e.canMove&&0==o.canMove&&0==s.canMove&&(cc.Mgr.AudioMgr.playSFX("GameOver"),this.gameState=n.Over,cc.Mgr.UserData.ClearReBoxMap(),cc.director.emit("ShowOver",{}))},RefreshLayOut:function(){for(var t=0;t<this.rowsNum;t++)for(var e=0;e<this.colsNum;e++)this.boxMap[t][e].InitBox(t,e,0);var o=this.getArrayByItems(this.rowsNum*this.colsNum,10),i=0,s=Math.floor(9*Math.random());this.schedule(function(){var t=Math.floor(o[i]/this.colsNum),e=o[i]%this.colsNum;cc.log("\u884c = "+t+"   \u5217 = "+e),cc.Mgr.AudioMgr.playSFX("Appear"),this.boxMap[t][e].PlayAnimation("boxspwan"),9==i?(this.boxMap[t][e].InitBox(t,e,this.playerFlagNum),this.checkPos[0]=t,this.checkPos[1]=e,cc.Mgr.Global.setCheckPos(t,e),this.gameState=n.Play):i==s?this.boxMap[t][e].InitBox(t,e,2):this.boxMap[t][e].InitBox(t,e,1),i+=1},.15,9,.5)},RefreshLayOutForTutorial:function(){for(var t=0;t<this.rowsNum;t++)for(var e=0;e<this.colsNum;e++)this.boxMap[t][e].InitBox(t,e,0);var o=[20,8,23,10,21,24,14,7,4,2],i=0;this.schedule(function(){var t=Math.floor(o[i]/this.colsNum),e=o[i]%this.colsNum;cc.log("\u884c = "+t+"   \u5217 = "+e),cc.Mgr.AudioMgr.playSFX("Appear"),this.boxMap[t][e].PlayAnimation("boxspwan"),9==i?(this.boxMap[t][e].InitBox(t,e,this.playerFlagNum),this.checkPos[0]=t,this.checkPos[1]=e,cc.Mgr.Global.setCheckPos(t,e),this.gameState=n.Play):3==i?this.boxMap[t][e].InitBox(t,e,2):this.boxMap[t][e].InitBox(t,e,1),i+=1},.15,9,.5)},getArrayByItems:function(t,e){for(var o=new Array,i=0;i<t;i++)o.push(i);for(var s=new Array,a=0;a<e&&o.length>0;a++){var n=Math.floor(Math.random()*o.length);s[a]=o[n],o.splice(n,1)}return s},checkCanMove:function(t){var e={canMove:!0,indexList:[]};if(t==i.LEFT){if(0==this.checkPos[1])return e.canMove=!1,e;for(var o=this.checkPos[1]-1;o>=0&&this.boxMap[this.checkPos[0]][o].boxType!=c.Stone;o--)0==this.boxMap[this.checkPos[0]][o].flagNum&&e.indexList.push(o);return 0==e.indexList.length&&(e.canMove=!1),e}if(t==i.RIGHT){if(this.checkPos[1]==this.colsNum-1)return e.canMove=!1,e;for(o=this.checkPos[1]+1;o<=this.colsNum-1&&this.boxMap[this.checkPos[0]][o].boxType!=c.Stone;o++)0==this.boxMap[this.checkPos[0]][o].flagNum&&e.indexList.push(o);return 0==e.indexList.length&&(e.canMove=!1),e}if(t==i.DOWN){if(this.checkPos[0]==this.rowsNum-1)return e.canMove=!1,e;for(o=this.checkPos[0]+1;o<=this.rowsNum-1&&this.boxMap[o][this.checkPos[1]].boxType!=c.Stone;o++)0==this.boxMap[o][this.checkPos[1]].flagNum&&e.indexList.push(o);return 0==e.indexList.length&&(e.canMove=!1),e}if(t==i.UP){if(0==this.checkPos[0])return e.canMove=!1,e;for(o=this.checkPos[0]-1;o>=0&&this.boxMap[o][this.checkPos[1]].boxType!=c.Stone;o--)0==this.boxMap[o][this.checkPos[1]].flagNum&&e.indexList.push(o);return 0==e.indexList.length&&(e.canMove=!1),e}return e},refreshCheckPos:function(t){this.checkPos[0]=t.x,this.checkPos[1]=t.y,cc.Mgr.Global.setCheckPos(t.x,t.y)},getCheckPos:function(){var t={};return t.row=this.checkPos[0],t.col=this.checkPos[1],t},getCheckPosBoxFlagNum:function(){return this.boxMap[this.checkPos[0]][this.checkPos[1]].flagNum},getPosBoxFlagNum:function(t,e){return this.boxMap[t][e].flagNum},getNullRectPos:function(){for(var t=[],e=0;e<this.colsNum;e++)for(var o=0;o<this.rowsNum;o++)if(0==this.boxMap[o][e].flagNum&&0==this.boxMap[o][e].IsCoinNodeActive()){var i={};i.row=o,i.col=e,t.push(i)}return t},JudeHasCheckNumNormalBoxInCol:function(t,e){for(var o=0,i=this.rowsNum-1;i>=0;i--)this.boxMap[i][e].boxType==c.Normal&&(o+=1);return o==t},JudeHasCheckNumNormalBoxInRow:function(t,e){for(var o=0,i=this.colsNum-1;i>=0;i--)this.boxMap[e][i].boxType==c.Normal&&(o+=1);return o==t},PickOutNullPosCantDispel:function(t){for(var e=[],o=t.length-1;o>=0;o--){var i=t[o].col,s=t[o].row,a=this.JudeHasCheckNumNormalBoxInRow(this.colsNum-1,s);if(0==this.JudeHasCheckNumNormalBoxInCol(this.rowsNum-1,i)&&0==a){var n={};n.row=s,n.col=i,e.push(n)}}return e},IsPosOnCheckPosWay:function(t){var e=this.getCheckPos();return e.row==t.row||e.col==t.col},PickOutPosOnWayDisFromCheckPos:function(t,e){for(var o=this.getCheckPos(),i=[],s=e.length-1;s>=0;s--)e[s].row+t!=o.row&&e[s].row-t!=o.row&&e[s].col+t!=o.col&&e[s].col-t!=o.col||i.push(e[s]);return i},PickOutNullPosOnCheckPosWay:function(t){for(var e=[],o=t.length-1;o>=0;o--)this.IsPosOnCheckPosWay(t[o])&&e.push(t[o]);return e},SpwanNewBox:function(t){var e=this;e.func=t,this.scheduleOnce(function(){var t=this.getNullRectPos(),o=this.PickOutNullPosCantDispel(t),i=this.PickOutNullPosOnCheckPosWay(o),s=this.getRatioSpawnStone();if(0==t.length)return cc.Mgr.AudioMgr.playSFX("GameOver"),this.gameState=n.Over,cc.Mgr.UserData.ClearReBoxMap(),void cc.director.emit("ShowOver",{});if(cc.Mgr.AudioMgr.playSFX("Appear"),0==o.length){var a=t[Math.floor(Math.random()*t.length)],c={},r=Math.random();c.flagNum=r<s?2:1,this.boxMap[a.row][a.col].RefreshBox(c),this.boxMap[a.row][a.col].PlayAnimation("boxspwan")}else if(0==i.length){a=o[Math.floor(Math.random()*o.length)],c={},r=Math.random();c.flagNum=r<s?2:1,this.boxMap[a.row][a.col].RefreshBox(c),this.boxMap[a.row][a.col].PlayAnimation("boxspwan")}else{if(Math.random()<.9){var h=Math.random();if(h<.5){var l=this.PickOutPosOnWayDisFromCheckPos(2,i);if(0==l.length){a=i[Math.floor(Math.random()*i.length)],c={},r=Math.random();c.flagNum=r<s?2:1,this.boxMap[a.row][a.col].RefreshBox(c),this.boxMap[a.row][a.col].PlayAnimation("boxspwan")}else{a=l[Math.floor(Math.random()*l.length)],c={},r=Math.random();c.flagNum=r<s?2:1,this.boxMap[a.row][a.col].RefreshBox(c),this.boxMap[a.row][a.col].PlayAnimation("boxspwan")}}else if(h<.9){var u=this.PickOutPosOnWayDisFromCheckPos(1,i);if(0==u.length){a=i[Math.floor(Math.random()*i.length)],c={},r=Math.random();c.flagNum=r<s?2:1,this.boxMap[a.row][a.col].RefreshBox(c),this.boxMap[a.row][a.col].PlayAnimation("boxspwan")}else{a=u[Math.floor(Math.random()*u.length)],c={},r=Math.random();c.flagNum=r<s?2:1,this.boxMap[a.row][a.col].RefreshBox(c),this.boxMap[a.row][a.col].PlayAnimation("boxspwan")}}else{var p=this.PickOutPosOnWayDisFromCheckPos(3,i);if(0==p.length){a=i[Math.floor(Math.random()*i.length)],c={},r=Math.random();c.flagNum=r<s?2:1,this.boxMap[a.row][a.col].RefreshBox(c),this.boxMap[a.row][a.col].PlayAnimation("boxspwan")}else{a=p[Math.floor(Math.random()*p.length)],c={},r=Math.random();c.flagNum=r<s?2:1,this.boxMap[a.row][a.col].RefreshBox(c),this.boxMap[a.row][a.col].PlayAnimation("boxspwan")}}}else{a=o[Math.floor(Math.random()*o.length)],c={},r=Math.random();c.flagNum=r<s?2:1,this.boxMap[a.row][a.col].RefreshBox(c),this.boxMap[a.row][a.col].PlayAnimation("boxspwan")}}e.func()},s.WaitSpwanInterval)},getRatioSpawnStone:function(){var t=cc.Mgr.UserData.getGameLv()-s.SpawnStoneLv,e=s.SpawnStoneInitRatio;return t>0?t/20>e?e:t/20:0},CheckCanDispelAfterSpwan:function(){this.scheduleOnce(function(){var t=this.CheckCanDispelCol(),e=this.CheckCanDispelRow();if(0==t.length&&0==e.length)this.gameState=n.Play,this.checkGameOver();else{if(cc.Mgr.AudioMgr.playSFX("Crush"),0!=t.length)for(var o=t.length-1;o>=0;o--)for(var i=this.rowsNum-1;i>=0;i--)this.boxMap[i][t[o]].boxType==c.Stone?s.DispelStoneScore:s.DispelNormalScore,this.boxMap[i][t[o]].PlayAnimation("boxblink");if(0!=e.length)for(o=e.length-1;o>=0;o--)for(i=this.colsNum-1;i>=0;i--)this.boxMap[e[o]][i].boxType==c.Stone?s.DispelStoneScore:s.DispelNormalScore,this.boxMap[e[o]][i].PlayAnimation("boxblink")}},s.WaitDispelInterval)},DoDispelOperate:function(){cc.Mgr.AudioMgr.playSFX("Move"),this.scheduleOnce(function(){var t=this.CheckCanDispelCol(),e=this.CheckCanDispelRow();if(cc.log("++++++++++++++++++ "+s.SpwanStep),0==t.length&&0==e.length)2==s.SpwanStep?this.SpwanNewBox(function(){this.CheckCanDispelAfterSpwan()}):this.gameState=n.Play;else{if(cc.Mgr.AudioMgr.playSFX("Crush"),0!=t.length)for(var o=t.length-1;o>=0;o--)for(var i=this.rowsNum-1;i>=0;i--)this.boxMap[i][t[o]].boxType==c.Stone?s.DispelStoneScore:s.DispelNormalScore,this.boxMap[i][t[o]].PlayAnimation("boxblink");if(0!=e.length)for(o=e.length-1;o>=0;o--)for(i=this.colsNum-1;i>=0;i--)this.boxMap[e[o]][i].boxType==c.Stone?s.DispelStoneScore:s.DispelNormalScore,this.boxMap[e[o]][i].PlayAnimation("boxblink")}},s.WaitDispelInterval)},CheckCanDispelCol:function(){for(var t=[],e=this.colsNum-1;e>=0;e--){for(var o=!0,i=0;i<this.rowsNum;i++)if(1!=this.boxMap[i][e].flagNum&&2!=this.boxMap[i][e].flagNum){o=!1;break}1==o&&t.push(e)}return t},CheckCanDispelRow:function(){for(var t=[],e=this.rowsNum-1;e>=0;e--){for(var o=!0,i=0;i<this.colsNum;i++)if(1!=this.boxMap[e][i].flagNum&&2!=this.boxMap[e][i].flagNum){o=!1;break}1==o&&t.push(e)}return t},OperateMoveAction:function(t,e){var o=this.checkCanMove(t);if(0!=o.canMove){this.gameState=n.Merge;var a=this;a.func=e,t==i.LEFT&&this.scheduleOnce(function(){for(var e=o.indexList[0];e<this.checkPos[1];e++){var i=e,s=this.getPosBoxFlagNum(this.checkPos[0],i+1),n={flagNum:0};this.boxMap[this.checkPos[0]][i+1].RefreshBox(n);var c={};if(c.flagNum=s,this.boxMap[this.checkPos[0]][i].RefreshBox(c),i==this.checkPos[1]-1){var r={};r.x=this.checkPos[0],r.y=i,this.refreshCheckPos(r)}}var h=this.checkCanMove(t);a.func(h)},s.moveOneInterval),t==i.RIGHT&&this.scheduleOnce(function(){for(var e=o.indexList[0];e>this.checkPos[1];e--){var i=e,s=this.getPosBoxFlagNum(this.checkPos[0],i-1),n={flagNum:0};this.boxMap[this.checkPos[0]][i-1].RefreshBox(n);var c={};if(c.flagNum=s,this.boxMap[this.checkPos[0]][i].RefreshBox(c),i==this.checkPos[1]+1){var r={};r.x=this.checkPos[0],r.y=i,this.refreshCheckPos(r)}}var h=this.checkCanMove(t);a.func(h)},s.moveOneInterval),t==i.UP&&this.scheduleOnce(function(){for(var e=o.indexList[0];e<this.checkPos[0];e++){var i=e,s=this.getPosBoxFlagNum(i+1,this.checkPos[1]),n={flagNum:0};this.boxMap[i+1][this.checkPos[1]].RefreshBox(n);var c={};if(c.flagNum=s,this.boxMap[i][this.checkPos[1]].RefreshBox(c),i==this.checkPos[0]-1){var r={};r.x=i,r.y=this.checkPos[1],this.refreshCheckPos(r)}}var h=this.checkCanMove(t);a.func(h)},s.moveOneInterval),t==i.DOWN&&this.scheduleOnce(function(){for(var e=o.indexList[0];e>this.checkPos[0];e--){var i=e,s=this.getPosBoxFlagNum(i-1,this.checkPos[1]),n={flagNum:0};this.boxMap[i-1][this.checkPos[1]].RefreshBox(n);var c={};if(c.flagNum=s,this.boxMap[i][this.checkPos[1]].RefreshBox(c),i==this.checkPos[0]+1){var r={};r.x=i,r.y=this.checkPos[1],this.refreshCheckPos(r)}}var h=this.checkCanMove(t);a.func(h)},s.moveOneInterval)}},MoveBoxLeft:function(t){this.OperateMoveAction(i.LEFT,function(t){0==t.canMove?(s.AddSpwanStep(),this.gameState=n.Merge,this.DoDispelOperate()):this.MoveBoxLeft(i.LEFT)})},MoveBoxRight:function(t){this.OperateMoveAction(i.RIGHT,function(t){0==t.canMove?(s.AddSpwanStep(),this.gameState=n.Merge,this.DoDispelOperate()):this.MoveBoxRight(i.RIGHT)})},MoveBoxUp:function(t){this.OperateMoveAction(i.UP,function(t){0==t.canMove?(s.AddSpwanStep(),this.gameState=n.Merge,this.DoDispelOperate()):this.MoveBoxUp(i.UP)})},MoveBoxDown:function(t){this.OperateMoveAction(i.DOWN,function(t){0==t.canMove?(s.AddSpwanStep(),this.gameState=n.Merge,this.DoDispelOperate()):this.MoveBoxDown(i.DOWN)})},onTouched:function(t){if(this.gameState==n.Play){this.SaveReBoxMapData(),s.hasMove=!0;var e=t.getStartLocation(),o=t.getLocation(),a=o.x-e.x,c=o.y-e.y;Math.abs(a)>Math.abs(c)?a>0?a>5&&this.MoveBoxRight(i.RIGHT):a<0&&a<-5&&this.MoveBoxLeft(i.LEFT):c>5?this.MoveBoxUp(i.UP):c<0&&this.MoveBoxDown(i.DOWN)}},onKey:function(t){if(this.gameState==n.Play)switch(this.SaveReBoxMapData(),s.hasMove=!0,t.keyCode){case cc.macro.KEY.up:case cc.macro.KEY.w:this.MoveBoxUp(i.UP);break;case cc.macro.KEY.down:case cc.macro.KEY.s:this.MoveBoxDown(i.DOWN);break;case cc.macro.KEY.left:case cc.macro.KEY.a:this.MoveBoxLeft(i.LEFT);break;case cc.macro.KEY.right:case cc.macro.KEY.d:this.MoveBoxRight(i.RIGHT)}}});e.exports=r,cc._RF.pop()},{Box:"Box",BoxType:"BoxType",DIR:"DIR",GameState:"GameState",Global:"Global",UIScore:"UIScore"}],GameState:[function(t,e,o){"use strict";cc._RF.push(e,"e8574c/3JdC3r6oCDUAjngc","GameState");var i=cc.Enum({Wait:0,Play:1,Over:2,Spwan:3,Merge:4,Pause:5});e.exports=i,cc._RF.pop()},{}],Global:[function(t,e,o){"use strict";cc._RF.push(e,"d2af1TemoxOJb1Yy4Sfzn0a","Global");var i=t("BonusType"),s=t("DataType"),a=cc.Class({statics:{SpwanStep:0,SpwanFlag:2,moveOneInterval:.01,WaitSpwanInterval:.15,WaitDispelInterval:.1,DispelNormalScore:10,DispelAddScore:50,LvScore:21,DispelStoneScore:50,SpawnStoneLv:10,SpawnStoneInitRatio:.3,ContinueRebornTimes:3,LeftRebornTime:3,UseSkillState:!1,SKillBoomNum:0,BoomCost:6e3,ReturnStepCost:4e3,PassLvGetCoin:100,DiamondGetScore:100,DiamondGetNum:90,CoinBonus:0,DiamondBonus:0,rewardGetLifeTime:300,canGetReward:!1,hasMove:!1,checkPos:[],RefreshBonusData:function(){var t=cc.Mgr.UserData.getCurSkinId(),e=cc.Mgr.DataMapMgr.getDataByDataTypeAndId(s.Skin,t).bonusList;this.CoinBonus=0,this.DiamondBonus=0;for(var o=e.length-1;o>=0;o--)e[o].bonusType==i.CoinBonus?this.CoinBonus+=e[o].bonusNum:e[o].bonusType==i.DiamondBonus&&(this.DiamondBonus=e[o].bonusNum);this.CoinBonus=1+this.CoinBonus/100,this.DiamondBonus=1+this.DiamondBonus/100,cc.log("+++++++++++++++++++++++++++++++++ "+this.CoinBonus)},InitRewardLifeTime:function(){this.rewardGetLifeTime=300,this.canGetReward=!1},SubLeftRewardTime:function(){0==this.canGetReward&&(cc.Mgr.Global.rewardGetLifeTime-=1,0==this.rewardGetLifeTime&&(this.canGetReward=!0))},AddSpwanStep:function(){this.SpwanStep+=1,this.SpwanStep>2&&(this.SpwanStep=1)},clearCheckPos:function(){this.checkPos[0]=-1,this.checkPos[1]=-1},InitData:function(){this.SpwanStep=0,this.SpwanFlag=2,this.SKillBoomNum=0,this.UseSkillState=!1,this.hasMove=!1,this.clearCheckPos()},setCheckPos:function(t,e){this.checkPos[0]=t,this.checkPos[1]=e}}});e.exports=a,cc._RF.pop()},{BonusType:"BonusType",DataType:"DataType"}],LvUpPanel:[function(t,e,o){"use strict";cc._RF.push(e,"5048b9EVlFHCLcDe/O9uWBI","LvUpPanel");var i=cc.Class({extends:cc.Component,properties:{getNumLbl:cc.Label},ShowPanel:function(t){this.getNumLbl.string=t.Num}});e.exports=i,cc._RF.pop()},{}],PlatformController:[function(t,e,o){"use strict";cc._RF.push(e,"05882nT34pGTa94tDlCdCoR","PlatformController");var i=cc.Class({statics:{wxSubContextViewLock:0,platform:"wx",Init:function(){window.wx||window.tt||window.swan||(this.platform="pc")},ShareTopNav:function(){var t=Math.floor(8*Math.random()),e=cc.Mgr.ShareInfos.getShareInfos(t);"wx"==this.platform?(wx.showShareMenu({withShareTicket:!0}),wx.onShareAppMessage(function(){return{title:e.text,imageUrl:e.url}})):"tt"==this.platform?(tt.showShareMenu(!1),tt.onShareAppMessage(function(){return{title:"\u6c99\u96d5,\u8fd9\u4e2a\u6e38\u620f\u4f60\u80fd\u73a9\u4e0b\u53bb\u5417",imageUrl:""}})):"baidu"==this.platform&&(swan.showShareMenu(!1),swan.onShareAppMessage(function(){return{title:e.text,imageUrl:e.url}}))},ShareToFriendTxt:function(t){"wx"==this.platform?(console.log("\u70b9\u51fb\u4e86\u5206\u4eab\u554a"),wx.shareAppMessage({title:t})):"tt"==this.platform?tt.shareAppMessage({title:t}):"baidu"==this.platform&&(console.log("\u70b9\u51fb\u4e86\u5206\u4eab\u554a"),swan.shareAppMessage({title:t}))},ShareToFriend:function(t){var e=cc.Mgr.ShareInfos.getShareInfos(t);"wx"==this.platform?(console.log("\u70b9\u51fb\u4e86\u5206\u4eab\u554a"),wx.shareAppMessage({title:e.text,imageUrl:e.url})):"tt"==this.platform?tt.shareAppMessage({title:e.text,imageUrl:e.url}):"baidu"==this.platform&&(console.log("\u70b9\u51fb\u4e86\u5206\u4eab\u554a"),swan.shareAppMessage({title:e.text,imageUrl:e.url}))},showToast:function(t){cc.log(t),"wx"==this.platform?wx.showToast({title:t,icon:"success",duration:2e3}):"tt"==this.platform?tt.showToast({title:t,icon:"success",duration:2e3}):"baidu"==this.platform&&swan.showToast({title:t,icon:"success",duration:2e3})},setUserCloudStorage:function(t){if(cc.log("setUserCloudStorage socre = "+t),"wx"==this.platform){var e={wxgame:{}};e.wxgame.score=t,e.wxgame.update_time=(new Date).getTime(),console.log(JSON.stringify(e));var o=new Array;o.push({key:"\bjzScore",value:JSON.stringify(e)}),wx.setUserCloudStorage({KVDataList:o,success:function(t){console.log("success:"+JSON.stringify(t))},fail:function(t){console.log("fail : "+t)}})}},IsSupportRank:function(){return"wx"==this.platform},showSubContentView:function(){if("wx"==this.platform){this.wxSubContextViewLock++,console.log("showSubContentView   "+this.wxSubContextViewLock);var t={flag:!0};cc.director.GlobalEvent.emit(cc.Mgr.Event.ShowRank,t)}},hideSubContentView:function(){if("wx"==this.platform&&(this.wxSubContextViewLock--,console.log("hideSubContentView   "+this.wxSubContextViewLock),0==this.wxSubContextViewLock)){var t={flag:!1};cc.director.GlobalEvent.emit(cc.Mgr.Event.ShowRank,t)}},SendMessageToSubView:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o={};o.code=t,o.curScore=e,"wx"==this.platform&&wx.getOpenDataContext().postMessage({message:o})}}});e.exports=i,cc._RF.pop()},{}],ReBox:[function(t,e,o){"use strict";cc._RF.push(e,"e788bZGBn1MUJM+EnB7LQak","ReBox");var i=cc.Class({name:"ReBox",properties:{posX:-1,posY:-1,flagNum:0,showCoin:!1},InitBox:function(t,e){this.posX=t,this.posY=e,this.flagNum=0,this.showCoin=!1},RefreshReBox:function(t,e){this.flagNum=t,this.showCoin=e}});e.exports=i,cc._RF.pop()},{}],SettingPanel:[function(t,e,o){"use strict";cc._RF.push(e,"99a9aWFrJJGAJhbDMGJ81Rh","SettingPanel");var i=cc.Class({extends:cc.Component,properties:{Atlas:cc.SpriteAtlas,checkMarkM:cc.Sprite,checkMarkV:cc.Sprite,vTipLbl:cc.Label,mTipLbl:cc.Label},ShowPanel:function(){0==cc.Mgr.AudioMgr.musicState?(this.checkMarkM.spriteFrame=this.Atlas.getSpriteFrame("m_off"),this.mTipLbl.string="\u97f3\u4e50:\u5173"):(this.checkMarkM.spriteFrame=this.Atlas.getSpriteFrame("m_on"),this.mTipLbl.string="\u97f3\u4e50:\u5f00"),0==cc.Mgr.AudioMgr.voiceState?(this.checkMarkV.spriteFrame=this.Atlas.getSpriteFrame("v_off"),this.vTipLbl.string="\u97f3\u6548:\u5173"):(this.checkMarkV.spriteFrame=this.Atlas.getSpriteFrame("v_on"),this.vTipLbl.string="\u97f3\u6548:\u5f00")},MusicTog:function(){0==cc.Mgr.AudioMgr.musicState?this.OnMusic():this.OffMusic()},VoiceTog:function(){0==cc.Mgr.AudioMgr.voiceState?this.OnVoice():this.OffVoice()},OnMusic:function(){cc.Mgr.AudioMgr.resumeMusic(),this.checkMarkM.spriteFrame=this.Atlas.getSpriteFrame("m_on"),this.mTipLbl.string="\u97f3\u4e50:\u5f00"},OffMusic:function(){cc.Mgr.AudioMgr.pauseMusic(),this.checkMarkM.spriteFrame=this.Atlas.getSpriteFrame("m_off"),this.mTipLbl.string="\u97f3\u4e50:\u5173"},OnVoice:function(){cc.Mgr.AudioMgr.resumeVoice(),this.checkMarkV.spriteFrame=this.Atlas.getSpriteFrame("v_on"),this.vTipLbl.string="\u97f3\u6548:\u5f00"},OffVoice:function(){cc.Mgr.AudioMgr.pauseVoice(),this.checkMarkV.spriteFrame=this.Atlas.getSpriteFrame("v_off"),this.vTipLbl.string="\u97f3\u6548:\u5173"},Help:function(){},KeFu:function(){}});e.exports=i,cc._RF.pop()},{}],ShareInfos:[function(t,e,o){"use strict";cc._RF.push(e,"cbabaJR2rFNv4Pbgoaogc9i","ShareInfos");var i=cc.Class({extends:cc.Component,statics:{init:function(){this.Infos=[{text:"\u4f60\u7684\u597d\u53cb\u5411\u4f60\u53d1\u51fa\u4e86\u6311\u6218,\u4f60\u6562\u5e94\u6218\u5417\uff1f",url:""},{text:"\u4f60\u7684\u597d\u53cb\u5411\u4f60\u53d1\u51fa\u4e86\u6311\u6218,\u4f60\u6562\u5e94\u6218\u5417\uff1f",url:""},{text:"\u4f60\u7684\u597d\u53cb\u5411\u4f60\u53d1\u51fa\u4e86\u6311\u6218,\u4f60\u6562\u5e94\u6218\u5417\uff1f",url:""},{text:"\u4f60\u7684\u597d\u53cb\u5411\u4f60\u53d1\u51fa\u4e86\u6311\u6218,\u4f60\u6562\u5e94\u6218\u5417\uff1f",url:""},{text:"\u4f60\u7684\u597d\u53cb\u5411\u4f60\u53d1\u51fa\u4e86\u6311\u6218,\u4f60\u6562\u5e94\u6218\u5417\uff1f",url:""},{text:"\u4f60\u7684\u597d\u53cb\u5411\u4f60\u53d1\u51fa\u4e86\u6311\u6218,\u4f60\u6562\u5e94\u6218\u5417\uff1f",url:""},{text:"\u4f60\u7684\u597d\u53cb\u5411\u4f60\u53d1\u51fa\u4e86\u6311\u6218,\u4f60\u6562\u5e94\u6218\u5417\uff1f",url:""},{text:"\u4f60\u7684\u597d\u53cb\u5411\u4f60\u53d1\u51fa\u4e86\u6311\u6218,\u4f60\u6562\u5e94\u6218\u5417\uff1f",url:""},{text:"\u672c\u6765\u53ea\u662f\u968f\u4fbf\u73a9\u73a9\uff0c\u5367\u69fd\u505c\u4e0d\u4e0b\u6765",url:""}]},getShareInfos:function(t){return this.Infos[t]}}});e.exports=i,cc._RF.pop()},{}],ShopPanel:[function(t,e,o){"use strict";cc._RF.push(e,"bba64AB7eBNtIe2AywpxO+S","ShopPanel");var i=t("SkinItem"),s=t("DataType"),a=t("BonusType"),n=cc.Class({extends:cc.Component,properties:{tipDesLbl:cc.Label,TipDesNode:cc.Node,Atlas:cc.SpriteAtlas,DesLbl:cc.Label,priceLbl:cc.Label,BuyUseBtnSp:cc.Sprite,skinItemList:[i],chooseId:10},start:function(){var t=this;cc.director.on("ChooseSkinItem",function(e){t.RefreshPanel(e.skinId)})},RefreshPanel:function(t){var e=cc.Mgr.UserData.IsSkinUnLock(t),o=cc.Mgr.DataMapMgr.getDataByDataTypeAndId(s.Skin,t);this.BuyUseBtnSp.spriteFrame=e?this.Atlas.getSpriteFrame("use"):this.Atlas.getSpriteFrame("buy_txt");for(var i="",n=o.bonusList.length-1;n>=0;n--)o.bonusList[n].bonusType==a.CoinBonus?i=i+"\u91d1\u5e01\u52a0\u6210:"+o.bonusList[n].bonusNum+"%":o.bonusList[n].bonusType==a.DiamondBonus&&(i=i+"\u94bb\u77f3\u52a0\u6210:"+o.bonusList[n].bonusNum+"%"),0!=n&&(i+="\n");this.priceLbl.string="\u4ef7\u683c:"+o.price,this.DesLbl.string=i,this.chooseId=t},ShowPanel:function(){for(var t=cc.Mgr.DataMapMgr.getDataListByDataType(s.Skin),e=0;e<=this.skinItemList.length-1;e++)null!=t[e]&&this.skinItemList[e].InitItem(t[e].skinId);this.RefreshPanel(cc.Mgr.UserData.getCurSkinId())},BuyUse:function(){var t=cc.Mgr.UserData.IsSkinUnLock(this.chooseId),e=cc.Mgr.DataMapMgr.getDataByDataTypeAndId(s.Skin,this.chooseId);if(t){cc.Mgr.UserData.refreshUseSkinId(this.chooseId);var o={};o.skinId=this.chooseId,cc.director.emit("UseSkin",o),this.ClosePanel()}else cc.Mgr.UserData.getDiamondNum()>=e.price?(cc.Mgr.UserData.addDiamondFunc(e.price),cc.director.emit("BuySkin",{}),cc.Mgr.UserData.UnlockSkinById(this.chooseId),this.BuyUseBtnSp.spriteFrame=this.Atlas.getSpriteFrame("use")):(this.TipDesNode.active=!0,this.tipDesLbl.string="\u4f60\u7684\u94bb\u77f3\u4e0d\u591f,\u60a8\u53ef\u4ee5\u901a\u8fc7\u89c2\u770b\u89c6\u9891\u5e7f\u544a\u83b7\u5f97,\u6216\u8005\u5728\u6e38\u620f\u4e2d\u79ef\u6512\u8db3\u591f\u94bb\u77f3")},ClosePanel:function(){this.node.active=!1}});e.exports=n,cc._RF.pop()},{BonusType:"BonusType",DataType:"DataType",SkinItem:"SkinItem"}],SkillUsePanel:[function(t,e,o){"use strict";cc._RF.push(e,"4acb1rSvg5N94jhZH7JV1Mx","SkillUsePanel");var i=cc.Class({extends:cc.Component,properties:{diamondLbl:cc.Label},ShowPanel:function(){this.diamondLbl.string="\u62e5\u6709:"+cc.Mgr.UserData.getCoinNum()},ClosePanel:function(){this.node.active=!1}});e.exports=i,cc._RF.pop()},{}],SkinBonus:[function(t,e,o){"use strict";cc._RF.push(e,"37e20KwaXVHq6zC2dE0WfBw","SkinBonus");cc.Class({name:"SkinBonus",properties:{bonusType:cc.Integer,bonusNum:cc.Integer}});cc._RF.pop()},{}],SkinData:[function(t,e,o){"use strict";cc._RF.push(e,"00be6HQojpEcqRlhiJGNEIw","SkinData");var i=t("SkinBonus"),s=cc.Class({name:"SkinData",properties:{skinId:cc.Integer,price:cc.Integer,bonusList:[i]}});e.exports=s,cc._RF.pop()},{SkinBonus:"SkinBonus"}],SkinItem:[function(t,e,o){"use strict";cc._RF.push(e,"5451boFJshI3rdpO5cEgXWM","SkinItem");var i=cc.Class({extends:cc.Component,properties:{skinId:cc.Integer,tog:cc.Toggle},InitItem:function(t){this.skinId=t,this.skinId==cc.Mgr.UserData.getCurSkinId()?this.tog.isChecked=!0:this.tog.isChecked=!1},ChooseItem:function(){var t={};t.skinId=this.skinId,cc.director.emit("ChooseSkinItem",t)}});e.exports=i,cc._RF.pop()},{}],SkinMap:[function(t,e,o){"use strict";cc._RF.push(e,"abccajbhrJH3YbOodi4LwEo","SkinMap");var i=t("SkinData"),s=t("SkinBonus"),a=cc.Class({extends:cc.Component,properties:{jsonName:"skin",skinList:{default:[],type:[i]}},DecodeJson:function(t){var e=this;e.reCb=t,cc.loader.loadRes("json/"+e.jsonName,function(t,o){if(t)e.reCb(!1);else{for(var a=o.json.skin,n=0;n<a.length;n++){var c=new i;c.skinId=a[n].skinId,c.price=a[n].price;for(var r=0;r<a[n].bonusList.length;r++){var h=new s;h.bonusType=a[n].bonusList[r][0],h.bonusNum=a[n].bonusList[r][1],c.bonusList[r]=h}e.skinList[n]=c}e.reCb(!0)}})},getDataById:function(t){for(var e=null,o=this.skinList.length-1;o>=0;o--)if(t==this.skinList[o].skinId){e=this.skinList[o];break}return e},getJsonLength:function(){return this.skinList.length},getDataList:function(){return this.skinList}});e.exports=a,cc._RF.pop()},{SkinBonus:"SkinBonus",SkinData:"SkinData"}],SkinStruct:[function(t,e,o){"use strict";cc._RF.push(e,"6f331O4fGJFobQN8AIUKtpF","SkinStruct");var i=cc.Class({name:"SkinStruct",properties:{skinId:cc.Integer,price:cc.Integer,unLock:0}});e.exports=i,cc._RF.pop()},{}],TutorialPanel:[function(t,e,o){"use strict";cc._RF.push(e,"44327xJKAVIJ5y40suV+Bs9","TutorialPanel");var i=t("GameController"),s=t("DIR"),a=cc.Class({extends:cc.Component,properties:{gameCtrl:i,FingerNode:cc.Node,Anima:cc.Animation,TipDesLbl:cc.Label,GoStep:1},start:function(){this.AddTouchEventListener()},OperFirstStep:function(){this.GoStep=1,this.Anima.play("tutorialFinger"),this.TipDesLbl.string="\u5411\u4e0b\u6ed1\u52a8,\u73a9\u5bb6\u67f1\u5b50\u53ef\u5c06\u7070\u8272\u67f1\u5b50\u63a8\u52a8"},OperFirstSubStep:function(){this.GoStep=2,this.Anima.play("tutorialFinger"),this.TipDesLbl.string="\u7ee7\u7eed\u5411\u4e0b\u6ed1\u52a8,\u53ef\u91c7\u96c6\u91d1\u5e01\u83b7\u5f97\u79ef\u5206"},OperSecondStep:function(){this.GoStep=3,this.Anima.play("tutorialFingerH"),this.TipDesLbl.string="\u5de6\u53f3\u6ed1\u52a8,\u53ef\u91c7\u96c6\u91d1\u5e01\u83b7\u5f97\u79ef\u5206"},OperThirdStep:function(){this.GoStep=4,this.FingerNode.active=!1,this.TipDesLbl.string="\u975e\u5e38\u597d,\u4f60\u5df2\u7ecf\u638c\u63e1\u4e86\u6e38\u620f\u89c4\u5219",cc.Mgr.UserData.FinishTutorial()},ClosePanel:function(){this.node.active=!1},AddTouchEventListener:function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouched,this)},onTouched:function(t){this.gameCtrl.SaveReBoxMapData(),cc.Mgr.Global.hasMove=!0;var e=t.getStartLocation(),o=t.getLocation(),i=o.x-e.x,a=o.y-e.y;Math.abs(i)>Math.abs(a)?i>0?i>5&&(3==this.GoStep?(this.gameCtrl.MoveBoxRight(s.RIGHT),this.scheduleOnce(function(){this.OperThirdStep()},.1)):4==this.GoStep&&(this.gameCtrl.MoveBoxRight(s.RIGHT),this.ClosePanel())):i<0&&i<-5&&(3==this.GoStep?(this.gameCtrl.MoveBoxLeft(s.LEFT),this.scheduleOnce(function(){this.OperThirdStep()},.1)):4==this.GoStep&&(this.gameCtrl.MoveBoxLeft(s.LEFT),this.ClosePanel())):a>5?4==this.GoStep&&(this.gameCtrl.MoveBoxUp(s.UP),this.ClosePanel()):a<0&&(1==this.GoStep?(this.gameCtrl.MoveBoxDown(s.DOWN),this.scheduleOnce(function(){this.OperFirstSubStep()},.5)):2==this.GoStep?(this.gameCtrl.MoveBoxDown(s.DOWN),this.scheduleOnce(function(){this.OperSecondStep()},.1)):4==this.GoStep&&(this.gameCtrl.MoveBoxDown(s.DOWN),this.ClosePanel()))}});e.exports=a,cc._RF.pop()},{DIR:"DIR",GameController:"GameController"}],UIMgr:[function(t,e,o){"use strict";cc._RF.push(e,"865c6W6/69HUqhmC8vxYaPi","UIMgr");var i=t("GameController"),s=t("SettingPanel"),a=t("GameState"),n=t("UIScore"),c=t("SkillUsePanel"),r=t("ShopPanel"),h=t("TutorialPanel"),l=cc.Class({extends:cc.Component,properties:{gameCtrl:i,StartUINode:cc.Node,OverUINode:cc.Node,RankUINode:cc.Node,BoomSkillBuyNode:cc.Node,BoomSkillTipNode:cc.Node,skillUsePanel:c,settingPanel:s,shopPanel:r,tutorialPanel:h,TipDesNode:cc.Node,highScoreLbl:cc.Label,boomHasNumLbl:cc.Label,leftRebornTimeLbl:cc.Label,tipDesLbl:cc.Label,uiScore:n,wxSubContextView:cc.Node},start:function(){var t=this;cc.director.on("ShowOver",function(e){t.ShowRebornPanel()}),cc.director.on("UseBoomSkillEnd",function(e){t.UseBoomSkillEnd()})},RefreshUI:function(){this.highScoreLbl.string="\u5386\u53f2\u6700\u4f73:"+cc.Mgr.UserData.getHighScore(),this.boomHasNumLbl.string=cc.Mgr.Global.SKillBoomNum},BackUIMenu:function(){this.StartUINode.active=!0,this.OverUINode.active=!1,this.RankUINode.active=!1,this.RefreshUI()},StartPlay:function(){cc.Mgr.AudioMgr.playSFX("Start"),this.wxSubContextView.active=!1,this.OverUINode.active=!1,cc.Mgr.PlatformController.SendMessageToSubView("GetRankList"),this.scheduleOnce(function(){this.StartUINode.active=!1,this.uiScore.ResetScore(),cc.Mgr.Global.InitData(),this.gameCtrl.gameState=a.Wait,this.gameCtrl.StartGame(),0==cc.Mgr.UserData.IsTutorialOver()&&this.scheduleOnce(function(){this.tutorialPanel.node.active=!0,this.tutorialPanel.OperFirstStep()},1.5)},.25)},RePlayStart:function(){cc.Mgr.AudioMgr.playSFX("Start"),this.wxSubContextView.active=!1,this.OverUINode.active=!1,cc.Mgr.PlatformController.SendMessageToSubView("GetRankList"),this.scheduleOnce(function(){this.StartUINode.active=!1,this.uiScore.ResetScore(),this.gameCtrl.ClearBoard(),cc.Mgr.Global.InitData(),this.gameCtrl.gameState=a.Wait,this.gameCtrl.ReStartGame()},.25)},OpenShop:function(){this.shopPanel.node.active=!0,this.shopPanel.ShowPanel()},RebornGame:function(){cc.Mgr.AudioMgr.playSFX("Start"),this.wxSubContextView.active=!1,this.OverUINode.active=!1,cc.Mgr.PlatformController.SendMessageToSubView("GetRankList"),this.scheduleOnce(function(){this.StartUINode.active=!1,this.gameCtrl.ClearBoard(),cc.Mgr.Global.InitData(),this.gameCtrl.gameState=a.Wait,this.gameCtrl.ReStartGame()},.25)},ShareToFriend:function(){cc.Mgr.PlatformController.ShareToFriend(2),this.RebornGame(),cc.Mgr.Global.LeftRebornTime-=1,cc.Mgr.Global.LeftRebornTime<0&&(cc.Mgr.Global.LeftRebornTime=3)},OpenRankPanel:function(){cc.Mgr.PlatformController.SendMessageToSubView("RankPanelOpen"),"wx"==cc.Mgr.PlatformController.platform&&(this.wxSubContextView.active=!0,this.RankUINode.active=!0)},CloseRankPanel:function(){cc.Mgr.PlatformController.SendMessageToSubView("RankPanelCloseInMainView"),this.wxSubContextView.active=!1,this.RankUINode.active=!1},ShowRebornPanel:function(){this.OverUINode.active=!0,this.leftRebornTimeLbl.string=cc.Mgr.Global.LeftRebornTime+"/"+cc.Mgr.Global.ContinueRebornTimes,this.wxSubContextView.active=!0,cc.Mgr.UserData.SaveData(),cc.Mgr.PlatformController.setUserCloudStorage(cc.Mgr.UserData.getHighScore()),cc.Mgr.PlatformController.SendMessageToSubView("ShowThreeNodes")},UseBoomSkillOpen:function(){this.gameCtrl.gameState==a.Play&&(0!=cc.Mgr.Global.SKillBoomNum?(cc.Mgr.Global.UseSkillState=!0,this.BoomSkillTipNode.active=!0,this.gameCtrl.OffTouchEventListener()):this.BoomSkillBuyNode.active=!0)},CancelUseBoomSkill:function(){cc.Mgr.Global.UseSkillState=!1,this.BoomSkillTipNode.active=!1,this.gameCtrl.AddTouchEventListener()},UseBoomSkillEnd:function(){cc.Mgr.Global.SKillBoomNum-=1,this.boomHasNumLbl.string=cc.Mgr.Global.SKillBoomNum,cc.Mgr.Global.UseSkillState=!1,this.BoomSkillTipNode.active=!1,this.gameCtrl.AddTouchEventListener()},BuyBoomSkill:function(){if(cc.Mgr.UserData.coin<cc.Mgr.Global.BoomCost){var t={des:"\u4f60\u7684\u91d1\u5e01\u4e0d\u591f,\u60a8\u53ef\u4ee5\u901a\u8fc7\u89c2\u770b\u89c6\u9891\u5e7f\u544a\u83b7\u5f97,\u6216\u8005\u5728\u6e38\u620f\u4e2d\u79ef\u6512\u8db3\u591f\u91d1\u5e01"};this.ShowTipDesPanel(t)}else cc.Mgr.Global.SKillBoomNum+=1,cc.Mgr.UserData.coin-=cc.Mgr.Global.BoomCost,this.uiScore.coinLbl.string=cc.Mgr.UserData.getCoinNum(),this.boomHasNumLbl.string=cc.Mgr.Global.SKillBoomNum},CloseBuyBoomPanel:function(){this.BoomSkillBuyNode.active=!1},ShowTipDesPanel:function(t){this.TipDesNode.active=!0,this.tipDesLbl.string=t.des},CloseTipDesPanel:function(){this.TipDesNode.active=!1},OpenSetting:function(){this.settingPanel.node.active=!0,this.settingPanel.ShowPanel()},CloseSettingPanel:function(){this.settingPanel.node.active=!1},ReturnOneStep:function(){if(cc.Mgr.UserData.getDiamondNum()<cc.Mgr.Global.ReturnStepCost){var t={des:"\u60a8\u7684\u91d1\u5e01\u4e0d\u591f"};this.ShowTipDesPanel(t)}else this.uiScore.AddCoinFunc(-cc.Mgr.Global.ReturnStepCost),this.skillUsePanel.node.active=!1,this.gameCtrl.ReturnOneStep(),cc.Mgr.Global.hasMove=!1},OpenUseSkillPanel:function(){if(this.gameCtrl.gameState==a.Play)if(0!=cc.Mgr.Global.hasMove)this.skillUsePanel.node.active=!0,this.skillUsePanel.ShowPanel();else{var t={des:"\u65e0\u9700\u56de\u9000,\u53ea\u6709\u79fb\u52a8\u8fc7\u540e\u624d\u80fd\u6267\u884c\u56de\u9000"};this.ShowTipDesPanel(t)}}});e.exports=l,cc._RF.pop()},{GameController:"GameController",GameState:"GameState",SettingPanel:"SettingPanel",ShopPanel:"ShopPanel",SkillUsePanel:"SkillUsePanel",TutorialPanel:"TutorialPanel",UIScore:"UIScore"}],UIScore:[function(t,e,o){"use strict";cc._RF.push(e,"849e3dPAkJPLqkYfhXhB8yQ","UIScore");var i=t("Global");cc.Class({extends:cc.Component,properties:{score:cc.Integer,gameLv:cc.Integer,ScoreLbl:cc.Label,diamondLbl:cc.Label,gameLvLbl:cc.Label,overScoreLbl:cc.Label,coinLbl:cc.Label,getCoinNumLbl:cc.Label,LvUpNode:cc.Node,getDiamondLbl:cc.Label,diamondDesLbl:cc.Label,diamondTitleLbl:cc.Label,getDiamondDesLbl:cc.Label,DiamondRewardNode:cc.Node,diamondForm:"Score"},start:function(){var t=this;cc.director.on("AddGameScore",function(e){t.AddScoreFunc(1)}),cc.director.on("BuySkin",function(e){t.RefreshUILbl()}),this.schedule(function(){this.SubLeftRewardTime(),1==cc.Mgr.Global.canGetReward?this.getDiamondDesLbl.string="\u53ef\u83b7\u5f97\u5956\u52b1":this.getDiamondDesLbl.string="\u5f53\u524d\u5269\u4f59:"+cc.Mgr.Global.rewardGetLifeTime+"s\u540e\u53ef\u83b7\u5f97\u5956\u52b1",this.getDiamondLbl.string=cc.Mgr.Global.DiamondGetNum+10*this.gameLv},1)},RefreshUILbl:function(){this.diamondLbl.string=cc.Mgr.UserData.getDiamondNum(),this.coinLbl.string=cc.Mgr.UserData.getCoinNum()},SubLeftRewardTime:function(){cc.Mgr.Global.SubLeftRewardTime()},AddScoreFunc:function(t){this.score+=t,this.ScoreLbl.string=this.score,this.overScoreLbl.string="\u672c\u5c40\u5f97\u5206:"+this.score;var e=this.gameLv;if(this.gameLv=Math.floor(this.score/i.LvScore)+1,this.gameLvLbl.string=this.gameLv,this.score>cc.Mgr.UserData.getHighScore()&&cc.Mgr.UserData.refreshHighScore(this.score),this.gameLv>e){this.LvUpNode.active=!0;var o=Math.floor((cc.Mgr.Global.PassLvGetCoin+10*this.gameLv)*cc.Mgr.Global.CoinBonus);this.getCoinNumLbl.string=o}if(cc.Mgr.UserData.refreshGameLv(),this.score%100==0&&0!=this.score&&0==this.LvUpNode.active){this.diamondForm="Score",this.DiamondRewardNode.active=!0,this.getDiamondDesLbl.node.active=!1,this.diamondDesLbl.node.active=!0,this.diamondTitleLbl.string="\u79ef\u5206\u5956\u52b1";o=Math.floor((cc.Mgr.Global.DiamondGetNum+10*this.gameLv)*cc.Mgr.Global.DiamondBonus);this.getDiamondLbl.string=o}},AddGetCoinFunc:function(){var t=Math.floor((cc.Mgr.Global.PassLvGetCoin+10*this.gameLv)*cc.Mgr.Global.CoinBonus);cc.Mgr.UserData.addCoinFunc(t),this.coinLbl.string=cc.Mgr.UserData.getCoinNum(),this.LvUpNode.active=!1},AddDoubleCoinFunc:function(){var t=2*Math.floor((cc.Mgr.Global.PassLvGetCoin+10*this.gameLv)*cc.Mgr.Global.CoinBonus);cc.Mgr.UserData.addCoinFunc(t),this.coinLbl.string=cc.Mgr.UserData.getCoinNum(),this.LvUpNode.active=!1},AddCoinFunc:function(t){cc.Mgr.UserData.addCoinFunc(t),this.coinLbl.string=cc.Mgr.UserData.getCoinNum()},AddDiamondFunc:function(t){cc.Mgr.UserData.addDiamondFunc(t),this.diamondLbl.string=cc.Mgr.UserData.getDiamondNum()},AddGetDiamondFunc:function(){if("Score"==this.diamondForm){var t=Math.floor((cc.Mgr.Global.DiamondGetNum+10*this.gameLv)*cc.Mgr.Global.DiamondBonus);cc.Mgr.UserData.addDiamondFunc(t)}else if(1==cc.Mgr.Global.canGetReward){t=cc.Mgr.Global.DiamondGetNum+10*this.gameLv;cc.Mgr.UserData.addDiamondFunc(t),cc.Mgr.Global.InitRewardLifeTime()}this.diamondLbl.string=cc.Mgr.UserData.getDiamondNum(),this.DiamondRewardNode.active=!1},AddDoubleDiamondFunc:function(){if("Score"==this.diamondForm){var t=2*Math.floor((cc.Mgr.Global.DiamondGetNum+10*this.gameLv)*cc.Mgr.Global.DiamondBonus);cc.Mgr.UserData.addDiamondFunc(t)}else if(1==cc.Mgr.Global.canGetReward){t=2*(cc.Mgr.Global.DiamondGetNum+10*this.gameLv);cc.Mgr.UserData.addDiamondFunc(t),cc.Mgr.Global.InitRewardLifeTime()}this.diamondLbl.string=cc.Mgr.UserData.getDiamondNum(),this.DiamondRewardNode.active=!1},ResetScore:function(){this.score=0,this.gameLv=1,this.ScoreLbl.string="0",this.overScoreLbl.string="\u672c\u5c40\u5f97\u5206:0",this.gameLvLbl.string="1",this.coinLbl.string=cc.Mgr.UserData.getCoinNum(),this.diamondLbl.string=cc.Mgr.UserData.getDiamondNum()},OpenTimeReward:function(){this.diamondForm="Time",this.DiamondRewardNode.active=!0,this.getDiamondDesLbl.node.active=!0,this.diamondDesLbl.node.active=!1,this.diamondTitleLbl.string="\u9650\u65f6\u5956\u52b1",this.getCoinNumLbl.string=cc.Mgr.Global.PassLvGetCoin+10*this.gameLv}});cc._RF.pop()},{Global:"Global"}],UserData:[function(t,e,o){"use strict";cc._RF.push(e,"36acdoQvwJHyaYwk2zo7hgr","UserData");var i=t("Global"),s=t("ReBox"),a=t("DataType"),n=t("SkinStruct"),c=cc.Class({extends:cc.Component,properties:{HighScore:0,coin:0,diamond:0,curUseSkinId:10,skinList:{default:[],type:[n]},tutorialOver:0,score:0,gameLv:1,colsNum:5,rowsNum:5},initData:function(){var t=cc.sys.localStorage.getItem("jz_userdata");if(null!=t&&""!=t){console.log("\u5e72\uff0c\u6709\u6570\u636e");var e=JSON.parse(t);this.HighScore=e.highscore,this.diamond=e.diamond,this.coin=e.coin,this.curUseSkinId=e.curUseSkinId,this.skinList=e.skinList,this.tutorialOver=e.tutorialOver,cc.log("\u6570\u636e = "+JSON.stringify(t))}else{console.log("\u5e72\uff0c\u4e4b\u524d\u6ca1\u6709\u6570\u636e");var o={skinList:null,highscore:0,coin:0,diamond:0,tutorialOver:0,curUseSkinId:10};this.HighScore=o.highscore,this.coin=o.coin,this.diamond=o.diamond,this.curUseSkinId=o.curUseSkinId,this.tutorialOver=o.tutorialOver;for(var i=cc.Mgr.DataMapMgr.getDataListByDataType(a.Skin),s=0;s<i.length;s++){var c=i[s],r=new n;r.skinId=c.skinId,r.price=c.price,10==c.skinId?r.unLock=1:r.unLock=0,this.skinList[s]=r}o.skinList=this.skinList,cc.sys.localStorage.setItem("jz_userdata",JSON.stringify(o))}this.InitRemBoxMap(),this.score=0,this.gameLv=1},UnlockSkinById:function(t){for(var e=this.skinList.length-1;e>=0;e--)if(this.skinList[e].skinId==t)return this.skinList[e].unLock=1,!0;return!1},InitRemBoxMap:function(){this.ReBoxMap=new Array(this.rowsNum);for(var t=0;t<this.rowsNum;t++){for(var e=new Array(this.colsNum),o=0;o<this.colsNum;o++)e[o]=new s;this.ReBoxMap[t]=e}for(t=0;t<this.rowsNum;t++)for(o=0;o<this.colsNum;o++)this.ReBoxMap[t][o].InitBox(t,o)},GetReBoxParam:function(t,e){var o={};return o.flagNum=this.ReBoxMap[t][e].flagNum,o.showCoin=this.ReBoxMap[t][e].showCoin,o},RefreshBoxMapRem:function(t,e,o,i){this.ReBoxMap[t][e].RefreshReBox(o,i)},ClearReBoxMap:function(){for(var t=0;t<this.rowsNum;t++)for(var e=0;e<this.colsNum;e++)this.ReBoxMap[t][e].InitBox(t,e)},getHighScore:function(){return this.HighScore},getCoinNum:function(){return this.coin},addCoinFunc:function(t){this.coin+=t},addDiamondFunc:function(t){this.diamond+=t},getDiamondNum:function(){return this.diamond},addScore:function(t){this.score+=t},getCurScore:function(){return this.score},refreshHighScore:function(t){t>this.HighScore&&(this.HighScore=t)},getGameLv:function(){return this.gameLv},refreshGameLv:function(t){this.gameLv=Math.floor(t/i.LvScore)+1},getCurSkinId:function(){return this.curUseSkinId},refreshUseSkinId:function(t){this.curUseSkinId=t,cc.Mgr.Global.RefreshBonusData(),this.SaveData()},IsSkinUnLock:function(t){for(var e=this.skinList.length-1;e>=0;e--)if(this.skinList[e].skinId==t)return 1==this.skinList[e].unLock;return!1},IsTutorialOver:function(){return 1==this.tutorialOver},FinishTutorial:function(){this.tutorialOver=1,this.SaveData()},SaveData:function(){var t={};t.highscore=this.HighScore,t.coin=this.coin,t.diamond=this.diamond,t.curUseSkinId=this.curUseSkinId,t.skinList=this.skinList,t.tutorialOver=this.tutorialOver,cc.sys.localStorage.setItem("jz_userdata",JSON.stringify(t))}});e.exports=c,cc._RF.pop()},{DataType:"DataType",Global:"Global",ReBox:"ReBox",SkinStruct:"SkinStruct"}]},{},["AudioMgr","BonusType","Box","BoxType","DIR","DataMapMgr","SkinBonus","SkinData","SkinMap","DataType","GameController","GameState","Global","PlatformController","ReBox","ShareInfos","SkinStruct","UserData","AppStart","CoinEffect","LvUpPanel","SettingPanel","ShopPanel","SkillUsePanel","SkinItem","TutorialPanel","UIMgr","UIScore"]);